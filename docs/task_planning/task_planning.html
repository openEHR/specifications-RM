<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="description" content="openEHR Task Planning Specification">
<meta name="keywords" content="task, planning, EHR, EMR, reference model, openehr">
<title>Task Planning Model Specification</title>
<link rel="stylesheet" href="http://www.openehr.org/releases/BASE/latest/resources/css/openehr.css">
<link rel="stylesheet" href="http://www.openehr.org/releases/BASE/latest/resources/css/pygments-murphy.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_task_planning_model_specification">Task Planning Model Specification</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_conformance">1.4. Conformance</a></li>
</ul>
</li>
<li><a href="#_background">2. Background</a>
<ul class="sectlevel2">
<li><a href="#_survey_of_requirements">2.1. Survey of Requirements</a></li>
<li><a href="#_limitations_of_the_openehr_standard_entry_model">2.2. Limitations of the openEHR standard Entry Model</a></li>
<li><a href="#_care_pathways_and_task_planning">2.3. Care Pathways and Task Planning</a></li>
<li><a href="#_execution_paradigm">2.4. Execution Paradigm</a></li>
<li><a href="#_relationship_to_workflow_formalisms_and_systems">2.5. Relationship to Workflow Formalisms and Systems</a></li>
</ul>
</li>
<li><a href="#_requirements">3. Requirements</a>
<ul class="sectlevel2">
<li><a href="#_planned_tasks_for_an_order">3.1. Planned Tasks for an Order</a></li>
<li><a href="#_order_sets_and_protocols">3.2. Order Sets and Protocols</a></li>
<li><a href="#_lookahead_plan">3.3. Lookahead Plan</a></li>
<li><a href="#_recurring_repeatable_tasks">3.4. Recurring / Repeatable Tasks</a></li>
<li><a href="#_checklist_sign_off">3.5. Checklist &amp; Sign-off</a></li>
<li><a href="#_teamwork_and_notifications">3.6. Teamwork and Notifications</a></li>
<li><a href="#_sub_plans">3.7. Sub-plans</a></li>
<li><a href="#_task_grouping_optionality_and_execution_basis">3.8. Task Grouping, Optionality and Execution Basis</a></li>
<li><a href="#_decision_pathways">3.9. Decision Pathways</a></li>
<li><a href="#_different_types_of_cancellation">3.10. Different types of Cancellation</a></li>
<li><a href="#_changes_and_abandonment">3.11. Changes and Abandonment</a></li>
<li><a href="#_rationalising_unrelated_task_plans">3.12. Rationalising Unrelated Task Plans</a></li>
<li><a href="#_support_process_analytics">3.13. Support Process Analytics</a></li>
<li><a href="#_support_for_costing_and_billing_information">3.14. Support for Costing and Billing Information</a></li>
</ul>
</li>
<li><a href="#_design_principles">4. Design Principles</a>
<ul class="sectlevel2">
<li><a href="#_conceptual_basics">4.1. Conceptual Basics</a>
<ul class="sectlevel3">
<li><a href="#_work_plan">4.1.1. Work Plan</a></li>
<li><a href="#_task_plan">4.1.2. Task Plan</a></li>
<li><a href="#_work_context">4.1.3. Work Context</a></li>
<li><a href="#_context_switching_and_forking">4.1.4. Context Switching and Forking</a></li>
<li><a href="#_principal_performer">4.1.5. Principal Performer</a></li>
<li><a href="#_allocation">4.1.6. Allocation</a></li>
</ul>
</li>
<li><a href="#_phases_of_definition_and_representation">4.2. Phases of Definition and Representation</a>
<ul class="sectlevel3">
<li><a href="#_separation_of_definition_and_execution">4.2.1. Separation of Definition and Execution</a></li>
<li><a href="#_model_of_change">4.2.2. Model of Change</a></li>
</ul>
</li>
<li><a href="#_execution_semantics">4.3. Execution Semantics</a>
<ul class="sectlevel3">
<li><a href="#_task_lifecycle">4.3.1. Task Lifecycle</a></li>
<li><a href="#_task_availability">4.3.2. Task Availability</a></li>
</ul>
</li>
<li><a href="#_relationship_of_task_plans_with_existing_openehr_entry_types">4.4. Relationship of Task Plans with existing openEHR Entry Types</a></li>
<li><a href="#_order_semantics_versus_plan_semantics">4.5. Order Semantics versus Plan Semantics</a></li>
</ul>
</li>
<li><a href="#_task_planning_model">5. Task Planning Model</a>
<ul class="sectlevel2">
<li><a href="#_overview">5.1. Overview</a></li>
<li><a href="#_class_descriptions">5.2. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_task_lifecycle_enumeration">5.2.1. TASK_LIFECYCLE Enumeration</a></li>
<li><a href="#_system_call_class">5.2.2. SYSTEM_CALL Class</a></li>
<li><a href="#_callback_type_enumeration">5.2.3. CALLBACK_TYPE Enumeration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_task_definition_model">6. Task Definition Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">6.1. Overview</a></li>
<li><a href="#_principal_types_and_structures">6.2. Principal Types and Structures</a>
<ul class="sectlevel3">
<li><a href="#_basic_semantics_of_all_task_types">6.2.1. Basic Semantics of all Task Types</a></li>
<li><a href="#_task_group_structure">6.2.2. Task Group Structure</a></li>
<li><a href="#_sub_plans_and_re_use">6.2.3. Sub-plans and Re-use</a></li>
<li><a href="#_hand_offs_and_coordinated_teamwork">6.2.4. Hand-offs and Coordinated Teamwork</a></li>
<li><a href="#_external_request">6.2.5. External Request</a></li>
<li><a href="#_system_request">6.2.6. System Request</a></li>
<li><a href="#_inline_defined_tasks">6.2.7. Inline Defined Tasks</a></li>
</ul>
</li>
<li><a href="#_decision_structures">6.3. Decision Structures</a></li>
<li><a href="#_plan_data_context">6.4. Plan Data Context</a></li>
<li><a href="#_detailed_plan_semantics">6.5. Detailed Plan Semantics</a>
<ul class="sectlevel3">
<li><a href="#_repetition">6.5.1. Repetition</a></li>
<li><a href="#_timing">6.5.2. Timing</a></li>
<li><a href="#_pre_conditions">6.5.3. Pre-conditions</a></li>
<li><a href="#_data_sets_and_application_interaction">6.5.4. Data-sets and Application Interaction</a></li>
<li><a href="#_training_level">6.5.5. Training Level</a></li>
<li><a href="#_references_to_design_time_artefacts">6.5.6. References to Design-time Artefacts</a></li>
</ul>
</li>
<li><a href="#_interaction_with_the_ehr">6.6. Interaction with the EHR</a>
<ul class="sectlevel3">
<li><a href="#_versioning_and_ehr_committal">6.6.1. Versioning and EHR Committal</a></li>
</ul>
</li>
<li><a href="#_task_availability_2">6.7. Task Availability</a></li>
<li><a href="#_class_descriptions_2">6.8. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_work_plan_class">6.8.1. WORK_PLAN Class</a></li>
<li><a href="#_task_plan_class">6.8.2. TASK_PLAN Class</a></li>
<li><a href="#_task_participation_class">6.8.3. TASK_PARTICIPATION Class</a></li>
<li><a href="#_plan_item_class">6.8.4. PLAN_ITEM Class</a></li>
<li><a href="#_task_item_class">6.8.5. TASK_ITEM Class</a></li>
<li><a href="#_task_precondition_class">6.8.6. TASK_PRECONDITION Class</a></li>
<li><a href="#_timing_spec_class">6.8.7. TIMING_SPEC Class</a></li>
<li><a href="#_clock_timing_class">6.8.8. CLOCK_TIMING Class</a></li>
<li><a href="#_event_linked_timing_class">6.8.9. EVENT_LINKED_TIMING Class</a></li>
<li><a href="#_temporal_relation_enumeration">6.8.10. TEMPORAL_RELATION Enumeration</a></li>
<li><a href="#_task_linked_timing_class">6.8.11. TASK_LINKED_TIMING Class</a></li>
<li><a href="#_state_linked_timing_class">6.8.12. STATE_LINKED_TIMING Class</a></li>
<li><a href="#_timing_reference_enumeration">6.8.13. TIMING_REFERENCE Enumeration</a></li>
<li><a href="#_task_group_class">6.8.14. TASK_GROUP Class</a></li>
<li><a href="#_task_repeat_class">6.8.15. TASK_REPEAT Class</a></li>
<li><a href="#_decision_group_class">6.8.16. DECISION_GROUP Class</a></li>
<li><a href="#_decision_path_group_class">6.8.17. DECISION_PATH_GROUP Class</a></li>
<li><a href="#_execution_type_enumeration">6.8.18. EXECUTION_TYPE Enumeration</a></li>
<li><a href="#_task_class">6.8.19. TASK Class</a></li>
<li><a href="#_linked_plan_class">6.8.20. LINKED_PLAN Class</a></li>
<li><a href="#_sub_plan_class">6.8.21. SUB_PLAN Class</a></li>
<li><a href="#_hand_off_class">6.8.22. HAND_OFF Class</a></li>
<li><a href="#_external_request_class">6.8.23. EXTERNAL_REQUEST Class</a></li>
<li><a href="#_system_request_class">6.8.24. SYSTEM_REQUEST Class</a></li>
<li><a href="#_defined_task_class">6.8.25. DEFINED_TASK Class</a></li>
<li><a href="#_dataset_spec_class">6.8.26. DATASET_SPEC Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_task_execution_model">7. Task Execution Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">7.1. Overview</a></li>
<li><a href="#_materialisation">7.2. Materialisation</a></li>
<li><a href="#_activation">7.3. Activation</a></li>
<li><a href="#_termination">7.4. Termination</a></li>
<li><a href="#_execution_time_semantics">7.5. Execution Time Semantics</a>
<ul class="sectlevel3">
<li><a href="#_allocation_and_re_allocation">7.5.1. Allocation and re-allocation</a></li>
<li><a href="#_task_lifecycle_model">7.5.2. Task Lifecycle Model</a></li>
<li><a href="#_notifications">7.5.3. Notifications</a></li>
<li><a href="#_persistence">7.5.4. Persistence</a></li>
<li><a href="#_context_switching">7.5.5. Context Switching</a></li>
</ul>
</li>
<li><a href="#_class_descriptions_3">7.6. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_m_task_plan_class">7.6.1. M_TASK_PLAN Class</a></li>
<li><a href="#_m_plan_data_context_class">7.6.2. M_PLAN_DATA_CONTEXT Class</a></li>
<li><a href="#_m_callback_class">7.6.3. M_CALLBACK Class</a></li>
<li><a href="#_m_plan_item_class">7.6.4. M_PLAN_ITEM Class</a></li>
<li><a href="#_m_task_item_class">7.6.5. M_TASK_ITEM Class</a></li>
<li><a href="#_m_task_group_class">7.6.6. M_TASK_GROUP Class</a></li>
<li><a href="#_m_task_class">7.6.7. M_TASK Class</a></li>
<li><a href="#_m_decision_group_class">7.6.8. M_DECISION_GROUP Class</a></li>
<li><a href="#_m_decision_path_group_class">7.6.9. M_DECISION_PATH_GROUP Class</a></li>
<li><a href="#_m_allocation_class">7.6.10. M_ALLOCATION Class</a></li>
</ul>
</li>
<li><a href="#_task_plan_execution_history">7.7. Task Plan Execution History</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_4">7.7.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_plan_execution_history_class">7.7.1.1. TASK_PLAN_EXECUTION_HISTORY Class</a></li>
<li><a href="#_event_record_class">7.7.1.2. EVENT_RECORD Class</a></li>
<li><a href="#_task_plan_event_record_class">7.7.1.3. TASK_PLAN_EVENT_RECORD Class</a></li>
<li><a href="#_task_event_record_class">7.7.1.4. TASK_EVENT_RECORD Class</a></li>
<li><a href="#_task_notification_record_class">7.7.1.5. TASK_NOTIFICATION_RECORD Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cost_tracking">7.8. Cost Tracking</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_5">7.8.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_costing_class">7.8.1.1. TASK_COSTING Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_transactional_micro_service">7.9. Transactional Micro-service</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_6">7.9.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_planning_ms_interface">7.9.1.1. TASK_PLANNING_MS Interface</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_relationship_with_other_openehr_ehr_artefacts">8. Relationship with other openEHR EHR Artefacts</a>
<ul class="sectlevel2">
<li><a href="#_todo">8.1. TODO</a></li>
<li><a href="#_execution_time_ehr_structures">8.2. Execution-time EHR Structures</a></li>
</ul>
</li>
<li><a href="#_scenarios">9. Scenarios</a>
<ul class="sectlevel2">
<li><a href="#_protocol_driven_plan">9.1. Protocol-driven Plan</a></li>
<li><a href="#_check_list_and_sign_off">9.2. Check-list and Sign-off</a></li>
<li><a href="#_changes_during_execution">9.3. Changes during Execution</a></li>
<li><a href="#_abandonment">9.4. Abandonment</a></li>
</ul>
</li>
<li><a href="#_implementation_guidance">10. Implementation Guidance</a>
<ul class="sectlevel2">
<li><a href="#_workflow_application_design">10.1. Workflow Application Design</a></li>
<li><a href="#_versioning">10.2. Versioning</a></li>
</ul>
</li>
<li><a href="#_references">References</a>
<ul class="sectlevel2">
<li><a href="#_publications">Publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="http://www.openehr.org/releases/BASE/latest/resources/images/openehr_logo_large.png" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_task_planning_model_specification" class="sect0">Task Planning Model Specification</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="http://www.openehr.org/programs/specification/">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: task, planning, EHR, EMR, reference model, openehr</p></td>
</tr>
</tbody>
</table>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="diagrams/openehr_block_diagram.png" alt="openEHR components" width="60%">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2017 - 2017 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="http://www.openehr.org/">The openEHR Foundation</a> is an independent, non-profit community organisation, facilitating the sharing of health records by consumers and clinicians via open-source, standards-based implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="http://www.openehr.org/releases/BASE/latest/resources/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://openehr.atlassian.net/browse/SPECPR/" class="bare">https://openehr.atlassian.net/browse/SPECPR/</a><br>
 Web: <a href="http://www.openehr.org/" class="bare">http://www.openehr.org/</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record">Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>R E L E A S E&#160;&#160;&#160;&#160;&#160;1.?.?</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.8.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">New Task subtypes; re-design 'system request' concept; build out callback classes; remove explicit notifications from model.<br>
 Improve performer model. Add more design material.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>22 Aug 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate changes from Workshop 28/29 July with Marand, DIPS, Lanit (Moscow). Change principal performer to Group level; add specialised Task types; add system request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Lah,<br>
 B Naess,<br>
 M Kejžar,<br>
 E Leonov,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">06 Jul 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate review comments from Boštjan Lah.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Lah,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rework runtime model.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate review comments from Pablo Pazos.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">06 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major rewrite, incorporating structure, parallelism, decision paths, and execution history.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31 May 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECRM-58">SPECRM-58</a>. Initial writing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,
 B Naess,
 I McNicoll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26 Jan 2017</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The work reported in this paper has been funded by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DIPS, Norway</p>
</li>
<li>
<p>Marand d.o.o., Slovenia</p>
</li>
<li>
<p>Ars Semantica, UK</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_trademarks">Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a trademark of the openEHR Foundation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document describes the openEHR Task Planning Model, which is a formal specification of information representing Planned Tasks. It is designed as a formal extension to the openEHR EHR Information Model, and assumes the types described in that specification.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>The open source healthcare community;</p>
</li>
<li>
<p>Solution vendors;</p>
</li>
<li>
<p>Medical informaticians and clinicians interested in health information.</p>
</li>
<li>
<p>Health data managers.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="http://www.openehr.org/releases/BASE/latest/architecture_overview.html">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="http://www.openehr.org/releases/RM/latest/ehr.html">openEHR EHR Information Model</a>;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at {openehr_rm_task_planning}.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
<div class="paragraph">
<p>Users are encouraged to comment on and/or advise on these paragraphs as well as the main content.  Feedback should be provided either on the <a href="http://lists.openehr.org/mailman/listinfo/openehr-technical_lists.openehr.org">technical mailing list</a>, or on the <a href="https://openehr.atlassian.net/browse/SPECPR/?selectedTab=com.atlassian.jira.jira-projects-plugin:issues-panel">specifications issue tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.4. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR Reference Model specification is determined by a formal test of that artifact against the relevant openEHR Implementation Technology Specification(s) (ITSs), such as an IDL interface or an XML-schema. Since ITSs are formal, automated derivations from the Reference Model, ITS conformance indicates RM conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_background"><a class="anchor" href="#_background"></a>2. Background</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_survey_of_requirements"><a class="anchor" href="#_survey_of_requirements"></a>2.1. Survey of Requirements</h3>
<div class="paragraph">
<p>This specification for a Task Planning facility for openEHR addresses requirements in a number of areas in which some form of 'planning' of clinical work is required. The defining characteristic of the requirements is that they primarily relate to an active human subject, rather than a passive object, such as a parcel or tissue sample. The requirements covered include one-off scheduled tasks (e.g. surgical procedure), long-running scheduled tasks (e.g. drug administration), recurring tasks (e.g. monitoring), and coordinated teamwork (e.g. acute stroke management).</p>
</div>
<div class="paragraph">
<p>In more sophisticated environments (generally hospitals), much task planning relates to guideline-based orders and medication administration. There are various levels at which to understand this, from care pathways (potentially covering management of a complex condition like sepsis) to specific workflows for particular elements of care within a pathway. One common conceptual entity is the so-called <em>order set</em>, which is generally understood as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a set of orders for medications and/or other therapies that are used together to achieve a particular clinical goal, e.g. the drugs for a particular chemotherapy regimen are often modelled as an order set;</p>
</li>
<li>
<p>potentially a detailed plan for administration of the items in the order set, which may be a fully planned out schedule of single administrations on particular days and times;</p>
</li>
<li>
<p>descriptive meta-data, including authors, history, evidence base, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In openEHR, the first element corresponds to a set of Instructions, while the second is a candidate for representation in openEHR via the Task Planning facility documented in this specification. Hence, the addition of Task Planning to openEHR provides an important element enabling the order set notion to be formalised in openEHR.</p>
</div>
<div class="paragraph">
<p>The specification also addresses the lack of fine-grained task planning facilities in the basic openEHR specifications, which are limited to the Instruction and Action concepts. These provide ways of stating orders and recording actions performed after the fact, but no way of representing or sharing plans for actions before they are performed. This limitation is described in more detail below.</p>
</div>
<div class="paragraph">
<p>The general approach followed here is to specify a representation of task plans at various stages in the planning lifecycle, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>design time</strong>: templates or prototypes of standard task plans are developed and published;</p>
</li>
<li>
<p><strong>runtime - planning</strong>: task plan prototypes are turned into concrete plans for specific work items for specific patients and activated;</p>
</li>
<li>
<p><strong>runtime - work execution</strong>: task plans are executed by clinical performers and the plan maintained up to date in real time;</p>
</li>
<li>
<p><strong>runtime - work completion</strong>: as each task is performed, standard clinical statements (openEHR Entries) are committed to the EHR to record what was done.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The models described here are thus designed to support both design-time modelling (via archetypes, terminology subsetting) and runtime execution with modifications and abandonment possible while the work is being performed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_limitations_of_the_openehr_standard_entry_model"><a class="anchor" href="#_limitations_of_the_openehr_standard_entry_model"></a>2.2. Limitations of the openEHR standard Entry Model</h3>
<div class="paragraph">
<p>The Entry model described in the <a href="http://www.openehr.org/releases/RM/latest/ehr.html">openEHR EHR IM</a> defines a way to record clinical statements representing real observations, decisions, orders and actions that have occurred, in the EHR. In this scheme, Instructions represent orders for certain kinds of Actions to be performed. Actions and Observations represent events that have subsequently occurred in the real world - a real drug administration or an actual blood sugar measurement.</p>
</div>
<div class="paragraph">
<p>There is however a common additional need to concretely plan individual Actions and sometimes Observations ahead of time, as a set of 'tasks', often known as a 'task list'. Here we will use the more general term <em>task plan</em> to mean a specification of a set of actions to be performed by actors (usually human, but potentially machine as well) providing care.</p>
</div>
<div class="paragraph">
<p>A set of planned tasks need not all relate to a single order, or indeed any order. The general picture is that a task plan corresponds to some self-standing healthcare job to be done, which may include tasks designed to fulfill multiple orders, and also tasks not defined by orders.</p>
</div>
<div class="paragraph">
<p>To meet this need, a further kind of content can be recorded in the EHR, representing task plans containing tasks. Here we understand the word 'task' to mean 'definition of a planned task', i.e. a description of something to be performed in the future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_care_pathways_and_task_planning"><a class="anchor" href="#_care_pathways_and_task_planning"></a>2.3. Care Pathways and Task Planning</h3>
<div class="paragraph">
<p>In order to respond to the need to formally represent clinical Task Plans, and to close the gap between orders and reported actions in openEHR, this specification provides a model of a <em>task planning</em> facility, which is conceptually situated in a larger semantic framework that includes entities at multiple levels, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>care pathway</em> - a structured description of care of a condition / ideal patient, typically including or referring to one or more <em>guidelines</em> that describe in detail how to deal with specific situations within the condition;</p>
</li>
<li>
<p><em>care plan</em> - a general plan for care of an actual patient, possibly using published Care Pathways and/or guidelines and taking into account individual specificities;</p>
</li>
<li>
<p><em>task plan</em> - a concrete definition of a set of fine-grained planned tasks for one or more actors to perform over time to achieve a particular goal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These entities and their relationships can be envisaged as follows.</p>
</div>
<div id="pathway_plan_triad" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/pathway_plan_triad.svg" alt="pathway plan triad" width="60%">
</div>
<div class="title">Figure 1. The care pathway / care plan / task plan triad</div>
</div>
<div class="paragraph">
<p>The above diagram shows task plans as a concrete planning artefact that results from a care plan for a specific patient, and may be partly based on published care pathways and clinical guidelines, each of which can be thought of as a basis for task plans for an ideal patient for a given condition (e.g. pregnancy, sepsis, stroke etc). Where care pathways (or parts thereof) can be represented as formal artefacts, they can act as prototypes for task pan structures. However, a care pathway for a model patient is not the same thing as a task plan(s) for an actual patient, since each real patient has his/her own specific combination of conditions, preferences and ultimately phenotypic specificities. Thus, where task plans are based on care pathways, the latter act as prototypes whose ideal form may be modified by the specific care plan and/or as the care team deems appropriate.</p>
</div>
<div class="paragraph">
<p>This specification addresses the representation and semantics of concrete task plans. It does not address the representation of the care plan and it does not say anything directly about formal care pathway representation, although it may be surmised for the future that the formal form of a care pathway may have significant commonality with the task plan model presented here, which may provide a useful guide for future work in care pathway representation.</p>
</div>
<div class="paragraph">
<p>The task plan model does however assume that a task plan may be <em>created</em> due to a care plan of some kind, and that the care plan may in turn have been derived from one or more care pathways or guidelines; accordingly, the means to identify the plan and pathway / guideline are provided.</p>
</div>
<div class="paragraph">
<p>In the following, the term 'task' denotes the definition of an action to be performed, the report of which is normally documented in openEHR by the <code>ACTION</code> Entry subtype. However, 'task' is also understood more generally, so that it may also when performed, result in an openEHR <code>OBSERVATION</code> or other Entry subtype where appropriate. In the great majority of cases therefore, the term 'task' as it appears here equates to openEHR Actions and Observations.</p>
</div>
<div class="paragraph">
<p>For the sake of brevity, 'Action' below is intended to imply an openEHR <code>ACTION</code>, <code>OBSERVATION</code> or potentially other Entry sub-type, unless otherwise stated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_paradigm"><a class="anchor" href="#_execution_paradigm"></a>2.4. Execution Paradigm</h3>
<div class="paragraph">
<p>As soon as the notion of 'planning' is assumed, we enter some form of the workflow space, and it becomes essential to describe the intended paradigm of the human / machine execution environment. This is due to the fact that any description of planned tasks acts as a set of instructions to actors intended to perform the tasks. Since the instructions (task plans) will be represented in the IT layer and the executing actors (generally human, although they may also be devices or software applications) exist in the real world, an account of the interaction between the computing environment and the real world is required.</p>
</div>
<div class="paragraph">
<p>Although the task plan facility described in this specification is relatively simple compared to some workflow tools, we can nevertheless distinguish the following entities in the environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>computing environment</em>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>work plan definition</strong>: a reusable definition of work to be done, consisting of tasks, potentially standardised according to a guideline or protocol;</p>
</li>
<li>
<p><strong>work plan instance</strong>: a run-time instance of a task plan, potentially with local variations, created for execution by an actor or actors;</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>real world</em>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>performing actor</strong>, i.e. a human, machine or software application that performs tasks in the real world as part of a procedure designed to achieve a goal;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In normal environments such as healthcare, the real-world actors are not passive recipients of commands from a computer application implementing a work plan, but are instead active agents who normally work together to perform a job. Working together involves peer to peer communication, ordering of tasks and so on. A workflow application provides help by maintaining a representation of the work plan, and a representation of its progress in execution. It is immediately apparent that the application&#8217;s idea of a given work plan execution and the real world state of the same work are not identical, and in fact may be only approximately related. For example, the computable form of the work plan might only include some of the tasks and actors at work in the real world. There are in fact two workflows executing: a virtual workflow and the real world one, and there is accordingly a problem of <em>synchronisation</em> of the two.</p>
</div>
<div class="paragraph">
<p>There is also a question of communication between the workflow application and the real world actors, which we can think of as consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>commands</strong>: signals from the work plan system to a real world actor to do something;</p>
</li>
<li>
<p><strong>notifications</strong>: signals to and from the work plan system and the real world actors on the status of work, e.g. 'new work item', 'item completed' etc;</p>
</li>
<li>
<p><strong>data</strong>: data collection from actors and presentation to actors from the system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This environment can be illustrated as follows.</p>
</div>
<div id="workflow_execution_paradigm" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/workflow_execution_paradigm.svg" alt="workflow execution paradigm" width="55%">
</div>
<div class="title">Figure 2. Work plan execution paradigm</div>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_to_workflow_formalisms_and_systems"><a class="anchor" href="#_relationship_to_workflow_formalisms_and_systems"></a>2.5. Relationship to Workflow Formalisms and Systems</h3>
<div class="paragraph">
<p>This specification describes a model for a 'task plan' concept that incudes support for work distribution across multiple performers, nested task plans, conditional branching, timing and various other facilities. Many of these are conceptually close to the features found in standard workflow languages such as <a href="http://www.bpmn.org/">BPMN</a> (Business Process Modelling Notation) and <a href="http://yawlfoundation.org/">YAWL</a> (Yet another Workflow Language), as well as emerging case-based standards such as <a href="http://www.omg.org/spec/CMMN/1.0/">CMMN</a> (Case Management Modelling Notation) and <a href="http://www.omg.org/spec/DMN/">DMN</a> (Decision Model and Notation).</p>
</div>
<div class="paragraph">
<p>While the model described here takes many ideas from these languauges, there are some key differencs as well. The primary conceptual difference is that the subject (i.e. 'case') here is assumed to be a) an intentional agent (generally a human patient) that makes choices, and b) an active biological organism, which reacts to drugs and other interventions. In other words, an entity that cannot be considered a passive object (such as a package or blood sample), as is the case for most logistic workflows, for which languages such as BPMN are designed.</p>
</div>
<div class="paragraph">
<p>The main consequence of this is that the design of a task plan is not taken to be a highly deterministic description whose exceptions are generally knowable in advance as they would be for a logistic system whose subjects are passive objects. Instead, tasks and groups of tightly-coupled tasks are specified in a more self-standing way, using preconditions rather than logical join and split operators. Note that even the patient can be a passive object in some circumstances, such as radiology.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements"><a class="anchor" href="#_requirements"></a>3. Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Task planning is applicable to numerous clinical scenarios, exemplified by the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>routine simple medication administration, e.g. for post-operative pain - tasks extend across worker shifts;</p>
</li>
<li>
<p>complex drug administration e.g. multi-drug chemotherapy over multiple days;</p>
</li>
<li>
<p>physiotherapy rehabilitation sessions - recurrent therapeutic procedure, with defined end-point;</p>
</li>
<li>
<p>dialysis - recurrent therapeutic procedure;</p>
</li>
<li>
<p>diet + physical activity plan for overweight treatment - recurrent tasks, patient as a performer;</p>
</li>
<li>
<p>surgery planning - one time event;</p>
</li>
<li>
<p>acute stroke management - multiple sets of tasks coordinated across multiple performers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within these and many other similar clinical procedures, a number of commonly occurring generic requirements appear, as described below.</p>
</div>
<div class="sect2">
<h3 id="_planned_tasks_for_an_order"><a class="anchor" href="#_planned_tasks_for_an_order"></a>3.1. Planned Tasks for an Order</h3>
<div class="paragraph">
<p>The simplest need is to be able to post a full plan of all actions to be performed for an order, in advance of the order commencing. This would result in a series of Tasks for each planned openEHR <code>ACTION</code> at execution time.</p>
</div>
<div class="paragraph">
<p>In openEHR, an order is represented by an <code>INSTRUCTION</code> instance, which contains a directive to do something such as preform radiography or administer medication. The form of representation in the Instruction is normally <em>interpretable</em> by an agent who will convert it to separate tasks. For example, a drug order for Amoxicillin 500mg oral tablet 3 times/day x 7 days is converted by a human agent to 21 separate tasks, each consisting of taking one tablet at a certain time or day. These tasks can be represented in a task plan, each task of which which can then be performed and signed off by a staff member, e.g. a shift nurse. The task plan acts as a record of what has been done, and what is left to do.</p>
</div>
<div class="paragraph">
<p>One difficulty with posting a full plan is that in some cases, the work is effectively open-ended, i.e. it has no currently known completion date. This might be because the patient condition being treated is chronic, e.g. insulin or Salbutamol (Ventolin) treatment; or it might be that although the condition is assumed to be limited in time, no current assumption can be made about when, e.g. pain medication of a trauma patient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_order_sets_and_protocols"><a class="anchor" href="#_order_sets_and_protocols"></a>3.2. Order Sets and Protocols</h3>
<div class="paragraph">
<p>A plan for a clinical intervention will typically need to encompass more than one order, in situations where drugs and other therapies are used according to a protocol or regime. For example, in multi-drug chemotherapy based on protocols like CHOP (non-Hodgkin&#8217;s lymphoma), COPP or Stanford V (Hodgkin&#8217;s lymphoma) etc, a single drug such as Cyclophosphamide is just a component. A task plan for administering chemotherapy according to a R-CHOP protocol would implicate orders for the drugs  (R)ituximab, (C)yclophosphamide, (H)ydroxydaunorubicin, (O)ncovin, and (P)rednisolone or Prednisone, and would accordingly include planned tasks for each of these drugs as they are administered according to the protocol.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drug</th>
<th class="tableblock halign-left valign-top">Standard [R]-CHOP-14 or<br>
 [R]-CHOP-21</th>
<th class="tableblock halign-left valign-top">[R]-Maxi-CHOP</th>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Days</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(R)ituximab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">375 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">375 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV infusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(C)yclophosphamide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">750 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1200 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV infusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(H)ydroxydaunorubicin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV bolus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(O)ncovin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4 mg/m² (max. 2 mg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 mg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV bolus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(P)rednisone or (P)rednisolone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 mg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PO qd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Days 1-5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>(Extract from <a href="https://en.wikipedia.org/wiki/CHOP">Wikipedia</a>.)</p>
</div>
<div class="paragraph">
<p>A more general notion is of a protocol or guideline, which is a full set of actions to be performed to achieve a goal. Some of the actions will have corresponding orders, but others, such as making intermediate observations, may not. Examples can be found at sites such as the <a href="https://pathways.nice.org.uk/">UK National Institute for Care and Excellence (NICE)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lookahead_plan"><a class="anchor" href="#_lookahead_plan"></a>3.3. Lookahead Plan</h3>
<div class="paragraph">
<p>A more flexible version of a plan is 'lookahead' planning, i.e. posting a plan of tasks for a moving window in time, e.g. one day, a few days, a few nursing rotations etc. The idea is not to try to plan out the entire plan execution, since it can easily change or be stopped, e.g. due to change in patient or other unexpected events. In a lookahead approach, some planned tasks are executed, and more planned tasks are added. The planned timing of each set of tasks may change due to the current situation, with the effect that the overall set of tasks that unfolds in time may well be different from an attempt to plan all tasks before any are executed.</p>
</div>
<div class="paragraph">
<p>For the open-ended cases mentioned above, the only option is a lookahead plan that extends as far ahead in time as the treating physicians are prepared to go.</p>
</div>
</div>
<div class="sect2">
<h3 id="_recurring_repeatable_tasks"><a class="anchor" href="#_recurring_repeatable_tasks"></a>3.4. Recurring / Repeatable Tasks</h3>
<div class="paragraph">
<p>Many clinical plans involve repetition over time. For example, the 14-day version of the CHOP protocol (CHOP-14) involves execution of the 5 day treatment every 14 days, for 3 iterations. Other clinical plans are essentially permanently recurring for the life of the patient, e.g asthma therapy.</p>
</div>
</div>
<div class="sect2">
<h3 id="_checklist_sign_off"><a class="anchor" href="#_checklist_sign_off"></a>3.5. Checklist &amp; Sign-off</h3>
<div class="paragraph">
<p>If a task plan is created, the constituent tasks can be viewed by workers as a checklist, and subsequently signed off as having been either performed or not done over time. The utility of this is that the correspondence between the tasks actually performed (represented by <code>ACTION</code>, <code>OBSERVATION</code> etc Entries) and the planned tasks is established. If a planned Action A1 is posted with execution time T, it might actually be performed at time T', but users still want to know that it was planned Action A1 that was intentionally performed, and not some other Action in the task plan. Over the course of the order execution, a picture will emerge of planned Actions being performed and signed off, possibly with some being missed as not needed, or not done for some other reason. Additional Actions not originally posted in the plan might also be done if they are allowed by the general specification of the relevant archetypes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_teamwork_and_notifications"><a class="anchor" href="#_teamwork_and_notifications"></a>3.6. Teamwork and Notifications</h3>
<div class="paragraph">
<p>In many cases, a task plan is intended for execution by a team of specialised performers, with each performer doing their part of the work, and at various points, passing control to another team member. Management of acute stroke is an example of this. In other cases, team members are working more or less in parallel, or by communicating in real time to each other. In both situations, if the workers are not physically in the same room at the same time, notifications are needed to alert each person when to start working on the subject; similarly, callback notifications are needed to alert original workers when other work has been completed, for example, an MRI image taken and report written.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sub_plans"><a class="anchor" href="#_sub_plans"></a>3.7. Sub-plans</h3>
<div class="paragraph">
<p>Plans can be described at varying levels of detail, depending on how workers are intended to work with them. One institution may describe an action such as cannulation atomically, relying on professional training and situational specifics to generate the correct concrete outcome, whereas another may require nurses to follow a guideline such as this <a href="http://emedicine.medscape.com/article/1998177-overview">Medscape Intravenous Cannulation</a> guideline. In cases where a self-standing clinical task is itself fully described in terms of steps, it is possible to represent the latter as its own task plan, and to be able to <em>refer</em> to it from another task plan. The general case is that any task that could be represented by a single item in a task plan could also be represented by a reference to a separate detailed task plan.</p>
</div>
</div>
<div class="sect2">
<h3 id="_task_grouping_optionality_and_execution_basis"><a class="anchor" href="#_task_grouping_optionality_and_execution_basis"></a>3.8. Task Grouping, Optionality and Execution Basis</h3>
<div class="paragraph">
<p>A set of tasks intended to achieve a defined goal could be performed sequentially or in parallel, and may include sub-groups of tasks that can performed together. A common situation is to have a task plan intended for sequential (i.e. ordered) execution by the agent, one of whose steps is actually a sub-group of tasks which can be executed in parallel (i.e. in any order).</p>
</div>
<div class="paragraph">
<p>It can also be assumed that some tasks in a task plan may be designated as optional, to be executed 'if needed' or on some other condition being true.</p>
</div>
<div class="paragraph">
<p>The general structure and execution semantics of a task plan therefore includes the notion of sequential or parallel execution of groups of tasks, and also optional execution of some tasks. We can consider the task plan itself as a outer group of tasks for which either sequential or parallel execution can be specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="_decision_pathways"><a class="anchor" href="#_decision_pathways"></a>3.9. Decision Pathways</h3>
<div class="paragraph">
<p>Task plans derived from semi-formal care pathways or guidelines (and potentially ad hoc designed plans) may contain 'decision points', which are of the following logical form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>decision point</strong>: a step containing a variable assignment of the form <code>$v := expression</code>;</p>
</li>
<li>
<p><strong>subordinate decision paths</strong>: groups of tasks each group of which has attached a variable test of the form <code>$v rel_op value</code>, where <code>rel_op</code> is one of <code>=</code>, <code>/=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code> or <code>&gt;=</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of decision points is shown below, in an extract from the <a href="https://intermountainhealthcare.org/ext/Dcmnt?ncid=520500199">Intermountain Healthcare Care Process Module (CPM) for Ischemic Stroke Management</a>:</p>
</div>
<div id="decision_pathway_example" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/IHC_stroke_decision_path.png" alt="IHC stroke decision path" width="80%">
</div>
<div class="title">Figure 3. Decision pathway example (Intermountain Healthcare Acute Stroke CPM)</div>
</div>
<div class="paragraph">
<p>In this example, the node containing the text "Further CLASSIFY &#8230;&#8203;" corresponds to a decision point that can be represented as <code>$symptom_onset_time := t</code>, where <code>t</code> is a time entered by a user. The subsequent nodes in the chart can be understood as paths based respectively on the tests <code>$symptom_onset_time &lt; 4.5h</code> and <code>4.5h &lt; $symptom_onset_time &lt; 6h</code>.</p>
</div>
<div class="paragraph">
<p>The ability to include decision pathways enables conditional sections of care pathways to be directly represented within a task plan.</p>
</div>
</div>
<div class="sect2">
<h3 id="_different_types_of_cancellation"><a class="anchor" href="#_different_types_of_cancellation"></a>3.10. Different types of Cancellation</h3>
<div class="paragraph">
<p>Tasks in a plan can be cancelled before being attempted for two types of reasons. One case is when the performer or the system realises the task can&#8217;t be performed (perhaps for lack of resources), and it is cancelled from the plan ahead of time. The other case is when the performer or system realises that the task isn&#8217;t needed, and can be cancelled as unnecessary, or already done by an external agent (e.g. an examination done at a night clinic).</p>
</div>
<div class="paragraph">
<p>In the first, case, the cancellation can be understood as a 'failed' task, whereas in the second, it is equivalent to a successful task. These two flavours of cancellation should be understood by the system so that plan success or failure can be reliably determiined.</p>
</div>
</div>
<div class="sect2">
<h3 id="_changes_and_abandonment"><a class="anchor" href="#_changes_and_abandonment"></a>3.11. Changes and Abandonment</h3>
<div class="paragraph">
<p>Inevitably, some task plans will have to be changed or abandoned partway through due to unexpected changes in the patient situation. The question here is: what should be done with the remaining planned tasks that will not be performed? Should they be marked as 'won&#8217;t do' (with some reason) and committed to the EHR, or should they be deleted prior to being committed to the EHR?</p>
</div>
<div class="paragraph">
<p>It is assumed that the answer will differ according to circumstance and local preference, in other words, that planned tasks that are created are not necessarily written into the EHR, but may initially exist in a separate 'planned tasks' buffer, and are only committed when each task is either performed or explicitly marked as not done, or else included in a list of not-done Actions to be committed to the EHR at a point of plan abandonment.</p>
</div>
<div class="paragraph">
<p>The following kinds of abandonment of tasks should be supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cancellation of an entire task plan that has been posted to the EHR or a 'planning buffer' if one exists;</p>
</li>
<li>
<p>cancellation of a particular task on a list ahead of time, with a reason;</p>
</li>
<li>
<p>marking a task as 'did not perform' after the planned time has passed, with a reason.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rationalising_unrelated_task_plans"><a class="anchor" href="#_rationalising_unrelated_task_plans"></a>3.12. Rationalising Unrelated Task Plans</h3>
<div class="paragraph">
<p>It is assumed that at any moment there could be multiple task plans extant for <em>different problems and timelines</em> for the same subject of care, e.g. chemotherapy, hypertension, ante-natal care. If naively created, these could clash in time and potentially in terms of other resources. There should therefore be support for being able to efficiently locate all existing task plans and scan their times, states and resources. This aids avoiding clashes and also finding opportunities for rationalising and bundling tasks e.g. grouping multiple tasks into a single visit, taking bloods require by two protocols at the same sitting etc.</p>
</div>
<div class="paragraph">
<p>It should be possible to process multiple task plans as part of interfacing with or constructing a 'patient diary', i.e. rationalised list of all work to be done involving the patient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_process_analytics"><a class="anchor" href="#_support_process_analytics"></a>3.13. Support Process Analytics</h3>
<div class="paragraph">
<p>As tasks are performed and signed off on the list of posted planned tasks, there will generally be differences between Actions actually performed and the tasks on the list. Differences may include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>time of execution - this will almost always be different, even if only by seconds;</p>
</li>
<li>
<p>performer - a task intended to be performed by a specific type of actor (say a nurse) might be performed by another (say the consultant);</p>
</li>
<li>
<p>any other modifiable detail of the order, e.g. medication dose in bedside care situations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These differences are obtainable from the EHR since both planned tasks and performed Actions will appear, providing a data resource for analysing business process, order compliance, reasons for deviation and so on.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_for_costing_and_billing_information"><a class="anchor" href="#_support_for_costing_and_billing_information"></a>3.14. Support for Costing and Billing Information</h3>
<div class="paragraph">
<p>It should be possible to record internal costing data against task plans as a whole, and also individual tasks. Additionally, it should be possible to attach external billing information to tasks and task plans. Costing information might be attached to each task, such as consumption of inventory items, time and other resources. Billing information is typically more coarse-grained and reported using nationally agreed code systems, e.g. ICD10 or similar.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_principles"><a class="anchor" href="#_design_principles"></a>4. Design Principles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections describe some of the key ideas in the design of the Task Planning model defined in this specification.</p>
</div>
<div class="sect2">
<h3 id="_conceptual_basics"><a class="anchor" href="#_conceptual_basics"></a>4.1. Conceptual Basics</h3>
<div class="sect3">
<h4 id="_work_plan"><a class="anchor" href="#_work_plan"></a>4.1.1. Work Plan</h4>
<div class="paragraph">
<p>The top-level formal concept defined here is the <em>Work Plan</em>, which consists of a set of one or more <em>Task Plans</em>. The Work Plan is a definition of work to be performed by one or more workers in order to achieve a defined goal with respect to a subject of care. Goals are often defined by published guidelines or care pathways, and the overall structure of work defined within a Work Plan and its constituent Task Plans may well be structured according to such publications.</p>
</div>
<div class="paragraph">
<p>Within a Work Plan, each included Task Plan is a definition of work to be performed in a single work <em>context</em>, typically by a single worker. Multiple Plans occur for two reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>distinct performers working in different contexts, across which managed <em>handoffs</em> are required;</p>
</li>
<li>
<p><em>sub-plans</em> subordinate to a parent Plan, to be performed by the same worker.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sub-plans occur to allow re-use of Plans for smaller pieces of work and also to provide a means of controlling the detail level of work differently for performers of different experience levels.</p>
</div>
<div class="paragraph">
<p>The entirety of the Work Plan definition is assumed to be executable within a single computational context, in which methods of notification and worker communication are available, enabling the state of progress of the work defined in the Plan to be fully represented computationally. A Work Plan will often be limited to a single enterprise, but this need not be the case, as long as all of its Task Plans communicate within the same Plan execution context. More typically, some jobs required by a Work Plan are performed in another organisational context entirely, and from the point of view of the original Work Plan, the second organsation is seen as a 'black box' to which a request can be made and a result might be returned. A common example is a hospital clinical workflow that at some point requires a laboratory result, which is processed by an external organisation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_plan"><a class="anchor" href="#_task_plan"></a>4.1.2. Task Plan</h4>
<div class="paragraph">
<p>The actual definition of work to be done, i.e. Tasks, occurs within each Task Plan. The most basic structuring notion required is that of a sequential list of Tasks, enabling the representation of the set of steps in a typical linear workflow such as making tea or cleaning a wound.</p>
</div>
<div class="paragraph">
<p>However, in the real world, almost every job can be sub-divided into smaller pieces of work in a fractal nature. This simple fact requires that the general structure of Tasks is actually a hierarchy, within which sequential lists occur commonly (and will be the top-level structure in simple cases). The formal construct provided for this is the Task Group, which may contain Tasks and more Task Groups.</p>
</div>
<div class="paragraph">
<p>The Task Group provides a convenient place to state <em>repetitions</em> that may be required or allowed, as occurs with many routine clinical and related jobs.</p>
</div>
<div class="paragraph">
<p>With hierarchy and sequential execution semantics, a great many types of work can be represented. However, some sets of Tasks can be performed without regard to order - i.e. in parallel. The model defined here therefore includes an execution type indicator at the Task Group level, so that manner of performing the work items within a Group - with or without regard to order - can be indicated. In purely sequential Task Plans, there is only one <em>execution path</em>. Parallel execution enables the possibility of multiple execution paths during a Plan execution.</p>
</div>
<div class="paragraph">
<p>The availability of parallelism in a Task Plan, particularly where the parallel elements are whole Task Groups, also creates the possibility of <em>choice</em>. Rather than every parallel path being mandatory or arbitrarily optional, a set of parallel paths may be chosen according to a <em>decision node</em> within the Plan, where a variable is evaluated and various value sub-ranges correspond to multiple paths. Such groups are represented by a Decision Group within the model, and each output path by a <em>Decision Path Group</em>.</p>
</div>
<div class="paragraph">
<p>The leaf level constituents of a Task Plan are Tasks of various kinds, including inline-defined Tasks; requests to other contexts within the same Work Plan; requests to external contexts and requests to IT systems and services.</p>
</div>
<div class="paragraph">
<p>The Task concept defined in this specification is relatively straightforward in the abstract: it corresponds to a separately performable <em>item of work</em> for a <em>performer</em> to execute. A Task within a Plan has a lifecycle whose states indicate whether it is planned, available, complete etc.</p>
</div>
<div class="paragraph">
<p>In business terms, a Task typically corresponds to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an explicit level of clinical responsibility, e.g. nurse administration of a drug, single observation of patient vital sign etc;</p>
</li>
<li>
<p>an explicit level of re-imbursement / billing;</p>
</li>
<li>
<p>granularity of check-list and protocol single items, designed to be signed off as performed;</p>
</li>
<li>
<p>a particular planned time of execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We can summarise the above-described structure in reverse:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Task</strong>: a separately performable unit of planned work at any level of granularity; may be defined inline or</p>
</li>
<li>
<p><strong>Task Group</strong>: a group of Tasks and/or more Task Groups within a Task Plan that are to be executed on the same basis, e.g. sequential, parallel.</p>
</li>
<li>
<p><strong>Decision Group</strong> and <strong>Decision Path Group</strong>: two special kinds of Group that enable decision nodes to be represented in a Plan.</p>
</li>
<li>
<p><strong>Task Plan</strong>: a logical set of Tasks for a single performer context to achieve a defined result within a larger plan.</p>
</li>
<li>
<p><strong>Work Plan</strong>: top-level structure containing related Task Plans needed to implement an intended outcome for a subject of care.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_work_context"><a class="anchor" href="#_work_context"></a>4.1.3. Work Context</h4>
<div class="paragraph">
<p>A fundamental concept in this specification is that of <em>work context</em>, which is the factor that distinguishes one Task Plan from another, i.e. one Plan corresponds to Tasks to be performed in a single work context. Work context is defined as a single, <em>contiguous cognitive flow</em> in the real world (i.e. not in the computational representation, which must always be considered an approximation updated in snapshot fashion) in which work can be performed <em>seamlessly</em> by one or more performers on a single subject. Concretely, this means that the flow of cognitive activity is unbroken during the work. This may extend over time and even distinct physical spaces, such as in the case of tele-consultations. Normally a single cognitive flow corresponds to a single actor, usually a person, but this is not always the case. More than one person may be involved in performing work on the same subject, but essentially working as one, and relying on real-time verbal or other communication to achieve the effect of a <em>single mind</em>.</p>
</div>
<div class="paragraph">
<p>Continuous knowledge of the work, and continuous real-time communication with oneself ('train of thought') or directly among multiple performers is what characterises a given context. A different context is one with different cognitive actors, and with which communications is performed by notifications at certain time checkpoints, typically just the beginning and end.</p>
</div>
<div class="paragraph">
<p>Since parallelism is possible within a single Plan, a performer may be working on more than one thing at once, within the same context. In other words, a work context (and a Task Plan in execution) may contain multiple execution paths at a point in time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_context_switching_and_forking"><a class="anchor" href="#_context_switching_and_forking"></a>4.1.4. Context Switching and Forking</h4>
<div class="paragraph">
<p>If work has to be stopped within one context and passed to a different work context, a <em>context switch</em> is required, and the first worker or team will wait for a response. If the context switch is within the same Work Plan, is termed a <em>handoff</em>, which entails switching Task Plans. A context change is also required to request work from an external environment. A second kind of change of control is a <em>context fork</em>, whereby the current performer signals to another context to start doing some work, but continues doing his own work.</p>
</div>
<div class="paragraph">
<p>A context switch is commonly known as 'block and wait' or 'synchronous processing', while the context fork is known as 'asynchronous' or 'parallel' processing.</p>
</div>
<div class="paragraph">
<p>Work context is clearly maintained during a 'working session' during which the work is done by one or more performers. But if the work extends over hours or days, as in the case of chemotherapy, worker shifts will end and the work will be taken up by new workers, or perhaps the same workers on the next day. The Task Planning model does not consider this kind of <em>handover</em> to be a context switch, since it is assumed that the Task Planning runtime system maintains all relevant context information, available for use by new workers. All that is required to maintain the context is for de-allocation and re-allocation of the work to performers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_principal_performer"><a class="anchor" href="#_principal_performer"></a>4.1.5. Principal Performer</h4>
<div class="paragraph">
<p>All Tasks in a Plan are defined to have a <em>principle performer</em>, that is to say, a single logical actor. This is often a single person (or a device or possibly a software service), but might equally be a group of personnel, e.g. ward nurses, who execute the steps of a Task Plan during and across shift boundaries (wound dressing, turning patients, IV maintenance etc). In these cases there is an understanding by separate individuals that they constitute a common workforce with respect to the subject of care, for any given planned piece of work.</p>
</div>
<div class="paragraph">
<p>The principal performer can be specified in terms of professional roles, and optionally a specific agent. This might in some cases be the patient.</p>
</div>
<div class="paragraph">
<p>The principle performer is defined to be attached to a Task Group in the model. This enables a Task Plan by default to have a single principle performer attached to the top-level Task Group, but to be overridden at lower level Groups.</p>
</div>
<div class="paragraph">
<p>In addition to the principal performer, other participations can be specified for any contained Task in a Plan. However it is assumed that the principal performer is <em>responsible</em> for all actions, and is also the notifier of action completions and cancellations, as well as the target of notifications to do with linked Task Plans.</p>
</div>
<div class="paragraph">
<p>The consequences of this design principle are twofold:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>where a team of executing actors is required to perform a logical procedure, <em>a Plan may have more than one principal performer in different Group sections, or alternatively, each distinct actor has his or her own Task Plan</em>;</p>
</li>
<li>
<p>for a team to operate together, coordination between the Task Plans and relevant actors is achieved by context switching.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A couple of subtleties are created by the design choice to allow more than one principal performer for a Plan. Firstly, where a change of principle performer is indicated in a Task Plan, a change of concrete actor is normally intended at execution time, but this need not always be so. A Plan designed for mainly nursing tasks with one or two tasks for a consultant or other specialist could be fully performed by a single professional having the specific capacities required by the Plan.</p>
</div>
<div class="paragraph">
<p>Secondly, a change in principal performer <em>within</em> a Task Plan is not treated as a formal context switch, i.e. one formally represented in the Plan. Instead, the switch is assumed to be undertaken by means of allocation of the relevant actors, in a seamless manner within the same cognitive context (typically managed by verbal communication).</p>
</div>
</div>
<div class="sect3">
<h4 id="_allocation"><a class="anchor" href="#_allocation"></a>4.1.6. Allocation</h4>
<div class="paragraph">
<p>Since a Task in a Task Plan being executed at runtime represents the Plan execution system&#8217;s knowledge of some work being performed in the real world, a way to connect the Task in the system (e.g. as shown on a UI application, or via notifications such as instant messaging) to the real-world actor performing it is needed. Following YAWL, the architecture described here treats <em>allocation</em> of work to a performer as a formal action during Plan execution. As per YAWL, more sophisicated implementations of Task Planning may offer numerous allocation strategies, such as first-available, quickest-to-complete, least-frequently-used and so on.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_phases_of_definition_and_representation"><a class="anchor" href="#_phases_of_definition_and_representation"></a>4.2. Phases of Definition and Representation</h3>
<div class="paragraph">
<p>Task Plans are defined, refined and used in various phases in time. A number of related technical representations are used, each appropriate to its phase.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 27.2727%;">
<col style="width: 54.5455%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Phase</th>
<th class="tableblock halign-left valign-top">Representation</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Definition template</strong><br>
                          (archetypes of definition<br>
                          classes)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Task Plan template is a 'prototypical' definition of a Task Plan that may be used in multiple situations;                                     it is represented in the form of openEHR templated archetype(s) based on the Task Planning definition
                                                      model of this specification.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical time -<br>
 planning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Concrete definition</strong><br>
                         (instances of definition<br>
                          classes)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When a Task Plan prototype is <em>used</em>, it is created as instances of the Task Planning definition
                                                      model (i.e. in the technical class/instance sense), and the result is understood as a <em>concrete</em> definition
                                                      of the Task Plan to be used in a specific situation for a specific subject (i.e. patient); any modifications allowed by the archetypes may be made to achieve the specific Task Plan needed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical time -<br>
 plan execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Materialised form</strong><br>
                        (instances of<br>
                         materialised classes,<br>
                         persisted over sessions)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At Plan execution time, a Task Plan definition will be 'materialised', i.e. instantiated into a form that can                                    be used for execution and tracking of the Plan. In this form, repeatable sections of the definition are                                          'unfolded' into literal sections, for as many repetitions as required by the relevant performer(s).
</p><p class="tableblock">                                                      Accordingly, parts of the materialised expression of a Plan may have an N:1 relationship with the original definition form. The materialised form has its own class model, containing additional data items to enable run-time tracking of the Plan as it is performed. During execution time, various kinds of deletions and modifications to the materialised representation, corresponding to changes in plan that respond to unexpected events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical time -<br>
 task execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Runtime instantiation</strong><br>
                        (instances of<br>
                         materialised classes,<br>
                         during session)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Since a Plan execution may run over many hours, days or longer, the materialised expression will in general                                     correspond to something larger than the literal in-memory instantiation of (parts of) the Plan required during                                   any given user-application the session during which some or all of the Task Plan might be performed. The part                                   of the plan currently being displayed, performed, tracked etc, is known here as the 'run-time instantiation',                                   and consists of a subset of the total materialised form instances.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In this scheme, archetypes and templates conveniently provide a prototype level of definition that supports standard models of similar but not identical kinds of Task Plan. For example, a single set of archetypes and templates could be used to represent Task Plans for hospital drug administration which can then be further customised for particular patients at the concrete definition level.</p>
</div>
<div class="sect3">
<h4 id="_separation_of_definition_and_execution"><a class="anchor" href="#_separation_of_definition_and_execution"></a>4.2.1. Separation of Definition and Execution</h4>
<div class="paragraph">
<p>According to the above, the concrete definition of a Task Plan is constructed in the 'planning phase' of clinical time, to define work <em>to be done</em> in the near future, by the planner and/or others. As the work is performed, the results are documented with openEHR Entries, such as Actions and Observations. During the execution of the plan there is usually a need to track the progress of the work in terms of Task completions, cancellations, failures, abandonment and so on.</p>
</div>
<div class="paragraph">
<p>As per the above table, the model defined in this specification separates the definition of Task Plans from their executions. This is achieved via <code>definition</code> and <code>materialised</code> parts of the model, corresponding to the concrete definition and materialised phases described above. Instances of the former are used to represent the definition of a plan, and would accordingly be used by a tools designed for that purpose. Similarly, run-time execution tools would be built using the <code>materialised</code> part of the model, as well as the <code>definition</code> part, since the latter is referred to by the former.</p>
</div>
<div class="paragraph">
<p>It is the materialised expression of a Plan that is used to record all Plan-related actions by Task performers. This state may be persisted for plans whose execution takes place over more than a user-application session.</p>
</div>
<div class="paragraph">
<p>The history of actions on the Plan can be understood as a set of <em>transactions</em> over time, and the model provides a third <code>history</code> part that can be used to efficiently represent this history, allowing it to be permanently recorded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_model_of_change"><a class="anchor" href="#_model_of_change"></a>4.2.2. Model of Change</h4>
<div class="paragraph">
<p>TODO: document how / when changes can be made, including during execution.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_execution_semantics"><a class="anchor" href="#_execution_semantics"></a>4.3. Execution Semantics</h3>
<div class="paragraph">
<p>A Work Plan definition can be executed by being materialised. The model recognises three states in the execution phase, as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>materialised</code> state: after creation of the materialised Plan, the Plan may be modified by its user(s), and connections must be established between the Plan execution context and various channels via which performer allocation and communication can be achieved.</p>
</li>
<li>
<p><code>activated</code> state: the materialised Plan is <em>activated</em> when the users want to proceed. This establishes the zero point of the execution clock, and will cause performer allocations and generate various kinds of notifications as time moves forward. During the work, Tasks become <em>available</em> (see below) as earlier Tasks are completed or cancelled. When a Task is available to be done, the performer has various options, including doing the work, cancelling the Task as not needed, completing the Task, aborting it, and abandoning the entire Plan.</p>
</li>
<li>
<p><code>terminated</code> state: A Plan terminates when a path taken through the materialised Task graph terminates, either due to finishing, or due to abandonment at an intermediate Task. The Plan as a whole returns a termination status of success or fail, which may be used to control behaviour if it is part of a chain in which a context switch follows termination.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_task_lifecycle"><a class="anchor" href="#_task_lifecycle"></a>4.3.1. Task Lifecycle</h4>
<div class="paragraph">
<p>Every Task in a Plan has a lifecycle described by a state machine. The states represent the state of a real world item of work, <em>as known by the Plan execution system</em>; setting them is entirely reliant on the system receiving input from performers. The successful execution path is through the states <code>planned</code> &#8658; <code>available</code> &#8658; <code>completed</code>, with other terminal states <code>cancelled</code> and <code>aborted</code> available for cases where a Task is cancelled and aborted respectively. Here, 'cancelled' means 'not needed', i.e. the principal performer determined Task could be cancelled before or during execution, without compromising the Plan. Conversely, the <code>aborted</code> state indicates that the performer cannot do or complete the Task, or the rest of the Plan. Thus, <code>aborted</code> for a Task means abandonment of the current Plan.</p>
</div>
<div class="paragraph">
<p>From the viewpoint of Plan execution, the final state of a Task execution determines whether the Plan remaints in the <code>active</code> state, or whether it enters the <code>terminated</code> state. If the Task terminates with <code>completed</code> or <code>cancelled</code> state, it is considered to have <em>succeeded</em>, and the Plan remains <code>active</code>. If the Task is <code>aborted</code>, it is considered as <em>failed</em>, and the Plan terminates with a failure status.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_availability"><a class="anchor" href="#_task_availability"></a>4.3.2. Task Availability</h4>
<div class="paragraph">
<p>A Task becomes <em>available</em> to perform when three kinds of condition are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plan control flow;</p>
</li>
<li>
<p>real world time, if execution time is specified in the Plan, and;</p>
</li>
<li>
<p>subject pre-conditions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Control flow reaches a Task in a Plan when either preceding Tasks have been performed (local control flow) or a previously dispatched external Task completes, whose restart location in the current Plan is the current Task.</p>
</div>
<div class="paragraph">
<p>Real-world execution time can be set for a Task, which means that even if it is available in terms of control flow, execution must wait until a specified time is reached. This may be simple clock time, a conventional time of day such as 'after lunch', or an event-relative time, such as 'at least 1 hour after last meal'.</p>
</div>
<div class="paragraph">
<p>If the control flow and time conditions are met, a Task will still not be available until any subject-related pre-conditions are met. These are conditions that may be specified to ensure the Task is only performed if it is clinically appropriate and safe to do so, such as 'systolic blood pressure &lt; 160 mmHg'.</p>
</div>
<div class="paragraph">
<p>Since the Task Plan cannot presume to have perfect knowledge of the real world situation, the performer is always allowed to override the time and subject pre-conditions, due to better knowledge. In such cases, the control flow requirement still holds - since this can already be 'overridden' by the performing cancelling preceding Tasks where appropruate.</p>
</div>
<div class="paragraph">
<p>When a Task does become available for execution, nothing will happen until a performer is allocated to do it. When an available worker is allocated, further life-cycle states can be reached, i.e. 'completed', 'aborted' etc.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates these concepts.</p>
</div>
<div id="task_semantics" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_semantics.svg" alt="task semantics" width="90%">
</div>
<div class="title">Figure 4. Task Semantics</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_of_task_plans_with_existing_openehr_entry_types"><a class="anchor" href="#_relationship_of_task_plans_with_existing_openehr_entry_types"></a>4.4. Relationship of Task Plans with existing openEHR Entry Types</h3>
<div class="paragraph">
<p>Within the phases of clinical planning and execution time described above, the Task Plan is not the only information artefact that may be created. The existing openEHR model <code>ENTRY</code> types provide the standard way to represent orders, via <code>INSTRUCTION</code>, and order-related performed activities, via <code>ACTION</code>. In addition, the usual <code>OBSERVATION</code>, <code>EVALUATION</code> and <code>ADMIN_ENTRY</code> types are used to record observations, diagnoses, and administrative events as they occur in clinical time. In abstract terms, Instructions may be understood as formal statements of 'what is to be done', and the other types, as records of 'what was done'. However, Instructions are most suited to concise representations of orderable actions, particularly medication administration, but not for general purpose detailed plans of events. The addition of Task Plans provides a way to specify such plans more flexibly, and in a step-by-step manner.</p>
</div>
<div class="paragraph">
<p>Both Instructions and Plans may be fully or partially defined by care pathways and/or guidelines, equally, they may be ad hoc developed in the 'old school medicine' sense. The following figure illustrates the relationships among care pathways, the existing openEHR Entry types and Task Plans.</p>
</div>
<div id="planning_artefact_relationships" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/planning_artefacts.svg" alt="planning artefacts" width="60%">
</div>
<div class="title">Figure 5. openEHR Planning Artefact Relationships</div>
</div>
<div class="paragraph">
<p>In simple cases, a Task Plan may just be the list of Tasks to fulfill one order, i.e. a single <code>INSTRUCTION</code> prescribing a course of antibiotics. The general case however is that the Task Plan corresponds to a clinical goal which implicates multiple orders, such as the CHOP chemotherapy mentioned above.</p>
</div>
<div class="paragraph">
<p>Consequently, <em>not every Task in a Task Plan is associated with an order</em>, illustrated by the yellow Task objects in the above figure. While a typical case is that a Task corresponds to an openEHR <code>ACTION</code> that has not yet been recorded (and which normally has a driving <code>INSTRUCTION</code>), it may also correspond to an <code>ACTION</code> that has no <code>INSTRUCTION</code> or indeed an <code>OBSERVATION</code> or possibly an <code>EVALUATION</code> (perhaps some kind of check during a procedure). Indeed, there is also no reason why a Task Plan cannot consist of Tasks that define administrative work and would be documented with openEHR <code>ADMIN_ENTRYs</code>.</p>
</div>
<div class="paragraph">
<p>We can infer from the above that the main driver of a Task Plan isn&#8217;t in general an order, but a care plan or guideline that usually includes orders, or else plain old ad hoc planning.</p>
</div>
<div class="paragraph">
<p>A high-level view of how clinical work generates openEHR information can be visualised conceptually with a modified version of the <a href="http://www.openehr.org/releases/RM/latest/ehr.html#_information_ontology">Clinical Investigator process diagram</a> as follows:</p>
</div>
<div id="clinical_process_planning" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/clinical_process_planning.svg" alt="clinical process planning" width="70%">
</div>
<div class="title">Figure 6. Clinical Investigator Process with Planning</div>
</div>
<div class="paragraph">
<p>According to this scheme, <code>TASK_PLAN</code> and <code>TASK</code> are new types of information that can be committed to the EHR.</p>
</div>
</div>
<div class="sect2">
<h3 id="_order_semantics_versus_plan_semantics"><a class="anchor" href="#_order_semantics_versus_plan_semantics"></a>4.5. Order Semantics versus Plan Semantics</h3>
<div class="paragraph">
<p>Despite the above explanation, the difference between Instructions (as defined in openEHR) and Task Plans may not be completely clear. However, there is a key difference, which is the semantic level at which the two are expressed. A typical order, represented in an openEHR <code>INSTRUCTION</code> has an <em>algorithmic</em> form, such as  "Amoxicillin 3 times a day, orally, for 7 days". Although healthcare professionals do not typically think about it, this expression is in fact a small program that is mentally <em>interpreted</em> to produce resultant actions such as giving one tablet at 9:15 am, one at lunch and so on.</p>
</div>
<div class="paragraph">
<p>We can think of a Task Plan for ordered actions as the interpreted form of the original order statement(s), that is to say, a completely 'unfolded' list of single Tasks in time such as 'give 1 Amoxycillin oral tab at lunch'. This is a form suitable for displaying on work lists, checking off and ensuring no mistakes are made. When a Task is performed, it will still give rise to the appropriate openEHR Entry recording the details, such as 'gave 1 Amoxycillin tab at 13:37'.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_planning_model"><a class="anchor" href="#_task_planning_model"></a>5. Task Planning Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>5.1. Overview</h3>
<div class="paragraph">
<p>The following UML diagram shows the <code>rm.task_planning</code> package in overview form, with the essential classes, inheritance and compositional relationships. The class <code>WORK_PLAN</code> is a descendant of <code>CONTENT_ITEM</code>, which makes it a type of content that may occur in a <code>COMPOSITION</code>. Compositions used for this purpose have their <code><em>category</em></code> attribute set to the openEHR coded term <code>|Task Plan|</code>. This enables Task Plans to be committed to the openEHR EHR if desired.</p>
</div>
<div class="paragraph">
<p>A <code>WORK_PLAN</code> is the outermost container for one or more <code>TASK_PLANs</code> that refer to each other in some way, as well as the meta-data documenting the plan.</p>
</div>
<div class="paragraph">
<p>Structurally, a <code>TASK_PLAN</code> has a <code><em>definition</em></code> (blue and green classes) consisting of various kinds of <code>TASK</code>. Individual Tasks that are <code>DEFINED_TASKs</code> (i.e. not references) may have a <code><em>prototype</em></code> whose type is an Entry descendant, that defines the Task data. The prototype is a partly-defined Entry that will be cloned and populated at runtime when/if the Task is completed.</p>
</div>
<div class="paragraph">
<p>At clinical execution time, the materialsed form of the Plan is represented by <code>M_XXX</code> classes, which are instantiated when the plan is activated (central orange classes).</p>
</div>
<div class="paragraph">
<p>A <code>TASK_PLAN</code> may also have an <code><em>execution_history</em></code> (gold classes at bottom), which acts as a record of events that have occurred to the Task Plan during execution.</p>
</div>
<div id="rm_task_planning_overview" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning-overview.svg" alt="RM task planning overview">
</div>
<div class="title">Figure 7. rm.task_planning package overview</div>
</div>
<div class="paragraph">
<p>The key structural relationships are shown in the following instance diagram. On the left is a Task Plan definition, consisting of a Task Group and various Defined Tasks. Each of these Tasks may have a prototype Entry attached, which represents the intended data of an Action, Observation or other Entry that the Task defines.</p>
</div>
<div class="paragraph">
<p>In the centre is a materialised Task Plan, which is an execution-time structure used to maintain state for an executing Plan (achieved by the <code>M_PLAN_ITEM.<em>definition</em></code> association). This structure allows the recording of all state to do with Task execution, including instances of variables, timing information and so on. The materialised structure is not owned by the definition structure, but rather is created at run time, and points back to its definition (<em>owner</em> and <em>definition</em> links). The right hand side shows a part of the materialised structure that is currently instantiated within a user-application session.</p>
</div>
<div class="paragraph">
<p>At the lower right is a Task Execution History, which is a record of all events that were made during the execution of the original Task Plan.</p>
</div>
<div id="task_planning_overview" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_planning_overview.svg" alt="task planning overview" width="75%">
</div>
<div class="title">Figure 8. Task planning overview</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions"><a class="anchor" href="#_class_descriptions"></a>5.2. Class Descriptions</h3>
<div class="paragraph">
<p>The following classes are common to all sub-packages.</p>
</div>
<div class="sect3">
<h4 id="_task_lifecycle_enumeration"><a class="anchor" href="#_task_lifecycle_enumeration"></a>5.2.1. TASK_LIFECYCLE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_LIFECYCLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration representing possible lifecycle states for a Task lifecycle transition, for example, "not needed".</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">planned</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is planned for the future.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">available</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is available for execution by performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">cancelled</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was cancelled without commencing.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">aborted</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was aborted after commencement, i.e. ended prematurely without meeting normal conditions of completion.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">completed</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was completed in the intended way.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">waiting</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is waiting for completion of a handoff or external request.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_system_call_class"><a class="anchor" href="#_system_call_class"></a>5.2.2. SYSTEM_CALL Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SYSTEM_CALL</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Definition of a request to make to an external system (i.e. information system or device) via its API, that reads or writes information specific to the Task to which it is attached in an actual Plan.</p>
</div>
<div class="paragraph">
<p>TODO: for REST API, call spec is probably just a URI.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_id</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of target system, typically a domain name.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>call_name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Name of call in API.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>parameters</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Call parameters.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_callback_type_enumeration"><a class="anchor" href="#_callback_type_enumeration"></a>5.2.3. CALLBACK_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALLBACK_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">resume_next</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Resume at the next Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">resume_specified</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Resume at a specified Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Retry the dispatch.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_definition_model"><a class="anchor" href="#_task_definition_model"></a>6. Task Definition Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>6.1. Overview</h3>
<div class="paragraph">
<p>The following figure shows the <code>rm.task_planning.definition</code> package in full.</p>
</div>
<div id="rm_task_planning_definition" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning.definition.svg" alt="RM task planning.definition">
</div>
<div class="title">Figure 9. rm.task_planning.definition model</div>
</div>
</div>
<div class="sect2">
<h3 id="_principal_types_and_structures"><a class="anchor" href="#_principal_types_and_structures"></a>6.2. Principal Types and Structures</h3>
<div class="paragraph">
<p>The following view of the above static model enables the key types and relationships that provide structure to be seen more easily.</p>
</div>
<div id="rm_task_planning_definition_tasks" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning.definition-tasks.svg" alt="RM task planning.definition tasks">
</div>
<div class="title">Figure 10. rm.task_planning.definition - Tasks view</div>
</div>
<div class="paragraph">
<p>The top-level structure for defining plans is a <code>WORK_PLAN</code>, which includes one or more related <code>TASK_PLANs</code> making up a logical goal-oriented plan. Inclusion is achieved via UID references to Task Plans (<code>WORK_PLAN.<em>plans</em></code>), not physical containment. This relationship allows related Task Plans to be grouped, which occurs for two reasons described earlier: re-use of Task Plans as <em>sub-plans</em> of other Task Plans, and team-based Plans, featuring <em>hand-offs</em>. How the Task Plans are linked to create these structures is enabled by particular sub-types of <code>TASK</code>, which may be understood by considering the model view above.</p>
</div>
<div class="paragraph">
<p>As can be seen, the <code><em>definition</em></code> of a <code>TASK_PLAN</code> is a <code>TASK_GROUP</code>, which has as its <code><em>members</em></code> any number of <code>PLAN_ITEMs</code>, of which the Task Group and various Task types are descendants. (The classes <code>DECISION_GROUP</code> and <code>DECISION_PATH_GROUP</code> are also <code>PLAN_ITEM</code> descendants, but are not included in the above view and are explained later.) This structure means that every Task Plan definition is contained in a Task Group, which contains any combination of more Task Groups and/or descendants of <code>TASK</code>.</p>
</div>
<div class="paragraph">
<p>The subtypes of <code>TASK</code> consist of the following (reaidng from the right hand side):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DEFINED_TASK</code>: an inline-defined Task to be performed by the principal performer of the Group;</p>
</li>
<li>
<p><code>SYSTEM_REQUEST</code>: a kind of Task that consists of a request to a computational system, such as a data retrieval or procedure call, on behalf of the current performer;</p>
</li>
<li>
<p><code>EXTERNAL_REQUEST</code>: a Task type that consists of a request to an external organisational entity that is outside the current Work Plan and its execution environment, on behalf of the current performer;</p>
</li>
<li>
<p><code>HAND_OFF</code>: a kind of Task that hands off to another Task Plan in the same Work Plan, having a different performer (identified via the <code><em>target</em></code> attribute inherited from <code>LINKED_PLAN</code>);</p>
</li>
<li>
<p><code>SUB_PLAN</code>: a kind of Task that stands for another Task Plan (identified by the inherited <code>LINKED_PLAN.<em>target</em></code> attribute) to be performed by the current performer - usually a fine-grained set of steps designed to achieve the result of this Task.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Three of these - <code>SYSTEM_REQUEST</code>, <code>EXTERNAL_REQUEST</code> and <code>HAND_OFF</code> - require passing the flow of work to another context, involving another party, which may be another human performer, an IT system or a machine. The flow may be specified to continue in the target context and then return to the current (block and wait), or it may be specified to fork so that the current flow continues in parallel with the external flow just created. These classes inherit from the class <code>DISPATCHABLE</code> which defines model attributes relevant to defining and controlling context switch.</p>
</div>
<div class="paragraph">
<p>The following sections provide more detail on some of these model features.</p>
</div>
<div class="sect3">
<h4 id="_basic_semantics_of_all_task_types"><a class="anchor" href="#_basic_semantics_of_all_task_types"></a>6.2.1. Basic Semantics of all Task Types</h4>
<div class="paragraph">
<p>The important semantics of the Task concept in the model are specified in the <code>PLAN_ITEM</code> and <code>TASK_ITEM</code> classes, with further specifics appearing in the <code>TASK_GROUP</code> and <code>TASK</code> descendants. Key attributes the <code>PLAN_ITEM</code> and <code>TASK_ITEM</code> include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>description</em></code>: natural language specification of the work of the Task;</p>
</li>
<li>
<p><code><em>preconditions</em></code>: operational conditions for determining if a Task is available for execution by a performer;</p>
</li>
<li>
<p><code><em>execution_time</em></code>: optional timing plan for Tasks;</p>
</li>
<li>
<p><code><em>costing_data</em></code>: fine-grained data to enable cost determination of work performed;</p>
</li>
<li>
<p><code><em>other_participations</em></code>: participations other than the principal performer;</p>
</li>
<li>
<p><code><em>training_level</em></code>: level of experience of performer; higher numbers indicate more experience.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From the control flow point of view, the <code><em>preconditions</em></code> and <code><em>execution_time</em></code> attributes are the ones that matter.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_group_structure"><a class="anchor" href="#_task_group_structure"></a>6.2.2. Task Group Structure</h4>
<div class="paragraph">
<p>The set of Tasks in Task Plan is represented within a containment structure created using instances of the <code>TASK_GROUP</code> type. This provides a way of grouping Tasks that will be executed collectively on the same basis, via the <code><em>execution_type</em></code> attribute, which may be set to <code>sequential</code> or <code>parallel</code>. This includes the top-level set of Tasks. A <code>TASK_GROUP</code> instance is treated as a member of its enclosing <code>TASK_GROUP</code> in the same way as constituent <code>TASK</code> instances, and shares with the latter attributes for Task description, timing, and conditions for execution.</p>
</div>
<div class="paragraph">
<p>The following illustrates the Task Plan structure including nested Task Groups.</p>
</div>
<div id="task_grouping" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_grouping.svg" alt="task grouping" width="25%">
</div>
<div class="title">Figure 11. Task grouping</div>
</div>
</div>
<div class="sect3">
<h4 id="_sub_plans_and_re_use"><a class="anchor" href="#_sub_plans_and_re_use"></a>6.2.3. Sub-plans and Re-use</h4>
<div class="paragraph">
<p>As described above, multiple Task Plans may be used to define a single logical plan of work. This occurs for two main reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>re-use</em>: Task Plans that can be used on their own, e.g. 'set up IV drip', are combined within a larger plan;</p>
</li>
<li>
<p><em>level of granularity</em>: a Task Plan can contain Tasks that can be represented as finer-grained Task Plans, which may potentially be used or passed over depending on the level of experience, known here as <em>training level</em> of the performer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following instance diagram illustrates.</p>
</div>
<div id="task_linking" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_linking.svg" alt="task linking" width="70%">
</div>
<div class="title">Figure 12. Task Plan linking</div>
</div>
<div class="paragraph">
<p>This shows a Plan for dialysis with a single performer, 'dialysis nurse', and several sub-plans, each referred to by an instance of the <code>SUB_PLAN</code> class. Since a Sub-plan is a kind of Task, it has a <em>description</em> and could be performed and signed off as if it were a normal inline <code>DEFINED_TASK</code> by an experienced performer (training level high), or it might be entered into by a performer such as a trainee nurse. The <code>PLAN_ITME.<em>training_level</em></code> attribute can be used to set the experience level of sub-plans if required; implementing this behaviour at execution time would rely in the Plan execution engine using these settings.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hand_offs_and_coordinated_teamwork"><a class="anchor" href="#_hand_offs_and_coordinated_teamwork"></a>6.2.4. Hand-offs and Coordinated Teamwork</h4>
<div class="paragraph">
<p>The second kind of Work Plan containing multiple Task Plans corresponds to a team work situation, where each Task Plan has a distinct principal performer, normally defined in terms of role and/or function, e.g. 'chemotherapy nurse' + 'assistant'.</p>
</div>
<div class="paragraph">
<p>Performing teamwork in a coordinated fashion with task planning support necessarily requires multiple Task Plans - one for each actor, and a means of coordination among them. This is achieved by the use of <code>HAND_OFF</code> class and the attributes inherited from <code>DISPATCHABLE</code>, i.e. <code><em>wait</em></code>, which determines switch or fork behaviour, and <code><em>xxx_action</em></code> attributes, which determine what to do depending on whether the requested work fails, succeeds or times out, for situations where the <code><em>wait</em></code> flag was set to <code>True</code>.</p>
</div>
<div class="paragraph">
<p>The following illustrates, using the example of an acute stroke management care process.</p>
</div>
<div id="task_coordination" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_coordination.svg" alt="task coordination" width="75%">
</div>
<div class="title">Figure 13. Task coordination</div>
</div>
<div class="paragraph">
<p>In this Work Plan, three Task Plans are used to perform (parts of) the clinical work coordinated for managing an acute stroke, as per a Care Pathway. There are two Hand-offs, the first synchronous (<code><em>wait</em></code> = <code>True</code>; <code><em>resume_task</em></code> = <code>next</code>) and the second an asynchronous fork (<code><em>wait</em></code> = <code>False</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_external_request"><a class="anchor" href="#_external_request"></a>6.2.5. External Request</h4>
<div class="paragraph">
<p>The Task sub-type <code>EXTERNAL_REQUEST</code> represents a request by the current performer to an external entity outside of the current Plan computation context to perform some work on behalf of the performer. This is normally an organisation of which routine requests can be made. The request is defined in terms of an organisation identifier, a request identifier (i.e. a name or type of job) and a list of other details, represented by the standard archetypable <code>ITEM_STRUCTURE</code>.</p>
</div>
<div class="paragraph">
<p>Since an External Request represents a context change, the <code>EXTERNAL_REQUEST</code> class inherits from <code>DISPATCHABLE</code>, which enables a switch or fork to be specified, and in the case of a switch, how to process the return of control or a timeout.</p>
</div>
</div>
<div class="sect3">
<h4 id="_system_request"><a class="anchor" href="#_system_request"></a>6.2.6. System Request</h4>
<div class="paragraph">
<p>In a similar way to External Request, the <code>SYSTEM_REQUEST</code> Task sub-type represents a request to a system with a computational interface on behalf of the performer. This might be to a special logging facility or a decision support system for example. The request is modelled in terms of a <code>SYSTEM_CALL</code> instance. It also inherits from <code>DISPATCHABLE</code> to enable context change handling.</p>
</div>
</div>
<div class="sect3">
<h4 id="_inline_defined_tasks"><a class="anchor" href="#_inline_defined_tasks"></a>6.2.7. Inline Defined Tasks</h4>
<div class="paragraph">
<p>Tasks whose definitions are stated within a Task Plan are modelled using the <code>DEFINED_TASK</code> type. A detailed specification of the work to be done in a Defined Task  may be stated via optional atttribute <code><em>prototype</em></code> of type <code>ENTRY</code>, which enables the details of a Task to be specified in terms of a descendant of the <code>ENTRY</code> class. This is typically an <code>ACTION</code> instance but could be an <code>OBSERVATION</code>, <code>ADMIN_ENTRY</code> or other descendant. The following view of the UML illustrates.</p>
</div>
<div id="rm_task_planning_definition_defined_task" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning.definition-defined_task.svg" alt="RM task planning.definition defined task">
</div>
<div class="title">Figure 14. rm.task_planning.definition - Definition Task</div>
</div>
<div class="paragraph">
<p>The attribute is called 'prototype' because the target Entry instance is understood as a partially populated, prototype 'planning time' partial copy of an Entry that will be created when the Task is actually performed. For example, a Task Plan for administering medication at 8 hourly intervals over a number of days could consist of a number of <code>DEFINED_TASKs</code>, each having a protoype of an <code>ACTION</code> instance based on the <code>openEHR-EHR-ACTION.medication.v1</code> archetype or a templated version thereof. Each such instance would contain the structured description of the medication administration and time, and when the administration was actually performed, an <code>ACTION</code> instance would be created from the prototype, modified to reflect any divergence from the planned form of the Task, and committed to the EHR in the normal way.</p>
</div>
<div class="paragraph">
<p>The following illustrates Task definitions using prototypes.</p>
</div>
<div id="task_definition" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_definition.svg" alt="task definition" width="35%">
</div>
<div class="title">Figure 15. Task definition</div>
</div>
<div class="paragraph">
<p>Assuming that the Task Plan is archetyped in the same way as Entries and other elements of the EHR, this scheme supports various modes of design-time specification. The <code><em>prototype</em></code> attribute in a <code>TASK_PLAN</code> archetype will usually be represented by an archetype slot or external reference, which specifies identifiers of permitted archetypes (or templates) of the target type, i.e. <code>ACTION</code> or other Entry. This can be used in various ways, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.openehr.org/releases/AM/latest/ADL2.html#_external_references">external reference</a>: specifies a fixed archetype identifier which will be substituted in the templated form of the Task Plan. This has the effect of creating <code>ACTION</code> or other prototype instances in the <code>TASK_PLAN</code> structure;</p>
</li>
<li>
<p><a href="http://www.openehr.org/releases/AM/latest/ADL2.html#_archetype_slots">archetype slot</a>: specified using a slot constraint that is satisfied by one or more archetypes that may be specified by a template, or left open until runtime.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the latter case, the slot may be filled in the Task Plan template with an <code>ACTION</code> or other Entry archetype, allowing the Tasks to be fully specified inline as in the external reference case. Alternatively, it may be left unresolved, which would allow the workflow application to choose the exact Task definition archetype at runtime.</p>
</div>
<div class="paragraph">
<p>One reason to allow a Task to contain a <code><em>prototype</em></code> reference that remains unresolved until runtime is if the Task represents the act of making an observation, for example, taking a blood pressure. In such cases, no prototype at all may be needed, and the Task <code><em>description</em></code> attribute (inherited from <code>PLAN_ITEM</code>) may be sufficient information for the performer. On the other hand, a prototype <code>OBSERVATION</code> could be specified in the <code>TASK_PLAN</code> template, which defines a particular form of the observation, e.g. a blood pressure which only records mean arterial pressure and cuff size.</p>
</div>
<div class="paragraph">
<p>To allow further flexibility, The multiplicity of the <code><em>prototype</em></code> attribute is unlimited, to allow for the possibility of one Task being prototyped by more than one Entry instance, e.g. an <code>ACTION</code> and an <code>OBSERVATION</code>, two <code>ADMIN_ENTRY</code> instances and so on.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-task-entry-corr: the alternative seems to be to allow a Task to correspond to e.g. a whole Composition template, where the <code>COMPOSITION</code> contains a number of e.g. <code>ACTIONs</code> or <code>OBSERVATIONs</code>. Problems I see with this: a) who knows what is in the Composition template? It may change over time; b) what if only some of the items in the Composition template can be done? Is the Task half complete? Or should the performer not do any of it?</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decision_structures"><a class="anchor" href="#_decision_structures"></a>6.3. Decision Structures</h3>
<div class="paragraph">
<p>A more advanced application of Task Plans includes decision structures in which Tasks are executed conditionally according to logic statements included in the Task Plan. In this model, a decision structure is represented by the classes <code>DECISION_GROUP</code> and <code>DECISION_PATH_GROUP</code>. These enable the decision points found in guidelines to be represented.</p>
</div>
<div id="rm_task_planning_definition_decision" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning.definition-decision.svg" alt="RM task planning.definition decision">
</div>
<div class="title">Figure 16. rm.task_planning package definition model (decision view)</div>
</div>
<div class="paragraph">
<p>The following diagram shows a typical decision structure.</p>
</div>
<div id="decision_structure" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/decision_structure.svg" alt="decision structure" width="50%">
</div>
<div class="title">Figure 17. Decision structure</div>
</div>
<div class="paragraph">
<p>A decision point is represented by a <code>DECISION_GROUP</code> instance, which contains a <code><em>value_expression</em></code> in the form of an assignment of an expression to a variable that can be later tested, and has its <code><em>execution_type</em></code> set to <code>conditional</code>. Each pathway is represented by a <code>DECISION_PATH_GROUP</code> instance with a <code><em>test_expression</em></code> in the form of an assertion on the same variable. By this method, the workflow engine can determine which group to execute based on the runtime value of the variable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plan_data_context"><a class="anchor" href="#_plan_data_context"></a>6.4. Plan Data Context</h3>
<div class="paragraph">
<p>A Task Plan may contain various logic <em>expressions</em>, occurring in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TASK_PRECONDITION.<em>expression</em></code>;</p>
</li>
<li>
<p><code>DECISION_GROUP.<em>value_expression</em></code> and <code>DECISION_PATH_GROUP.<em>test_expression</em></code>;</p>
</li>
<li>
<p><code>TASK_REPEAT.<em>terminate_condition</em></code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These expressions may mention variables that are typically related to subject state, such as patient vital signs, key demographic characteristics and so on, or the clinical care process, such as the 'time since stroke event'. In order to allow expressions to use symbolic variables such as <code>is_female</code> or <code>stroke_time</code> within logical expressions, a way of defining each variable is required. This is provided by the <code>CONTEXT_VARIABLE</code> type within <code>PLAN_DATA_CONTEXT</code>, a data context object at the Task Plan level.</p>
</div>
<div class="paragraph">
<p>Each context variable has a symbolic name, type from within the openEHR type system, and a <em>populating_request</em>, which defines how to populate the variable with a System Request, typically an EHR query or similar.</p>
</div>
<div class="paragraph tbd">
<p>TBD: to be continued; see also <a href="http://www.openehr.org/releases/BASE/latest/expression.html">openEHR Expression language</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_detailed_plan_semantics"><a class="anchor" href="#_detailed_plan_semantics"></a>6.5. Detailed Plan Semantics</h3>
<div class="sect3">
<h4 id="_repetition"><a class="anchor" href="#_repetition"></a>6.5.1. Repetition</h4>
<div class="paragraph tbd">
<p>TBD: to be described</p>
</div>
</div>
<div class="sect3">
<h4 id="_timing"><a class="anchor" href="#_timing"></a>6.5.2. Timing</h4>
<div class="paragraph">
<p>In the coordinated team work situation, the timing of Tasks tends to be based on previous Tasks completing and/or receipt of completion notifications from Tasks being performed by other actors. However, for scenarios such as routine drug administration, the timing of Tasks can be specified directly. The following view of the model shows the timing classes in detail.</p>
</div>
<div id="rm_task_planning_definition_timing" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning.definition-timing.svg" alt="RM task planning.definition timing">
</div>
<div class="title">Figure 18. rm.task_planning package definition model (timing view)</div>
</div>
<div class="paragraph">
<p>This is achieved via the <code><em>execution_time</em></code> attribute, whose value at runtime is understood as a guide, enabling Tasks to be placed on a scheduled timeline. A performer may execute the Task earlier or later than the indicated time, with the final <code>ACTION</code> or other Entry recording the actual time.</p>
</div>
<div class="paragraph">
<p>The timing of a Task, may be expressed in three different ways, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>clock time</em>: the Task is to be executed at a specific clock time represented by an instance of <code>CLOCK_TIMING</code>; within a Task definition, this must be specified as a relative duration with respect to the origin clock time of the Task Plan, which is only known in absolute terms at execution time;</p>
</li>
<li>
<p><em>event-linked time</em>: the Task is to be executed at a time related to a real world event, such as a meal or sleeping; in this case, an instance of <code>EVENT_LINKED_TIME</code> is used; the attributes indicate the specifics such as '1 hour before', 'with meal' etc;</p>
</li>
<li>
<p><em>task-link time</em>: the Task is to be executed at a time related to the timing of another Task event, such as completion of the previous Task; this is represented by an instance of <code>TASK_LINKED_TIME</code>, whose attributes define the specifics;</p>
</li>
<li>
<p><em>state-linked time</em>: the Task is to be executed at a time related to the state of the subject, as specified by an instance of <code>STATE_LINKED_TIMING</code>. This uses a Boolean-valued <code><em>condition</em></code> attribute to state a condition which when true indicates that a Task time-to-execute has been reached. The <code><em>test_period</em></code> attribute indicates when to retest the condition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>TODO: add a max time or time-out.</p>
</div>
<div class="paragraph">
<p>Each of these timing specification types inherits from the <code>TIMING_SPEC</code> class, which provides an optional <code><em>start_window</em></code> attribute, enabling any time to be specified with an additional 'within x time'.</p>
</div>
<div class="paragraph">
<p>If no <code><em>execution_time</em></code> is specified, a Task is assumed to be available for execution if other (non-temporal) availability conditions are met and:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for Tasks in a sequential group, as soon as the previous Task has been completed;</p>
</li>
<li>
<p>for Tasks in a parallel group, as soon as the group becomes available.</p>
</li>
</ul>
</div>
<div class="paragraph tbd">
<p>ISSUE-time-relativity: time is somewhat complicated. In a TASK_PLAN archetype we need to use relative offsets everywhere, but at runtime, we need absolute times. We could consider setting an 'origin time' for the Task Plan as a whole when it is instantiated, and computing absolute times for each Task at that point. However, at runtime, the timings may be changed by the performer (e.g. times to admin drugs) and the intention is probably to make them 'stick', even if the notional origin time is moved. However in other cases, the idea may be to move the origin and have all the times move.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pre_conditions"><a class="anchor" href="#_pre_conditions"></a>6.5.3. Pre-conditions</h4>
<div class="paragraph">
<p>In addition to timing, other conditions may determine when or if a Task can be performed. These are modelled as the <code>TASK_ITEM</code> attribute <code><em>preconditions</em>: TASK_PRECONDITION</code>. A precondition is formally represented as a <code>DV_PARSABLE</code>, which would normally contain a string in <a href="http://www.openehr.org/releases/BASE/latest/expression.html">openEHR Expression Language</a> syntax, but may contain another syntax.</p>
</div>
<div class="paragraph">
<p>Pre-conditions are intended to be used to express real-world conditions containing references to subject state, such as vital signs, white cell count and so on. Pre-conditions should be evaluated at the point at which the Task to which they are attached enter the lifecycle state <code>available</code>. If any pre-condition evaluates to False, the Task is in theory unable to be performed. A clinical professional may override at execution time, since it may always be the case that particular circumstances obviate the need for a particular pre-condition that normally applies.</p>
</div>
</div>
<div class="sect3">
<h4 id="_data_sets_and_application_interaction"><a class="anchor" href="#_data_sets_and_application_interaction"></a>6.5.4. Data-sets and Application Interaction</h4>
<div class="paragraph">
<p>Within the definition of a Defined Task, one or more data-sets may be specified for review and / or capture purposes (<code>DEFINED_TASK.<em>review_dataset</em></code> and <code><em>caputre_dataset</em></code>). A 'data-set' in openEHR is a template, normally displayed as a form within an application. Either a template or form identifier (or both) maybe be used to specify a data-set. A review data-set is specified to signal to the Task Plan runtime system to request the display of data at the start of the Task, in order to provide data needed by the user for the Task and potentially following Tasks. A capture data-set is specified when the purpose of the Task is to record data.</p>
</div>
<div class="paragraph tbd">
<p>TBD: a single attribute may be sufficient.</p>
</div>
</div>
<div class="sect3">
<h4 id="_training_level"><a class="anchor" href="#_training_level"></a>6.5.5. Training Level</h4>
<div class="paragraph">
<p>One challenge with creating Task Plan definitions is the level of detail to use, with respect to the variable level of skill of different performers. For a senior nurse, a briefer version of the Plan would be preferable with actions such as 'set up IV with catheter' being a single atom, whereas a trainee may need to see a more detailed set of sub-tasks.</p>
</div>
<div class="paragraph">
<p>To enable a single Plan to be used in both ways, the concept of 'training level' is included in the model, on the <code>TASK_GROUP</code> class. This enables any Group of Tasks to be marked as having a specific training level, where a higher number corresponds to less experience. At execution time, the training level of the allocated performer can be obtained, and then used in comparison to the training level indicated on each Group (including the top-level Group of the whole Plan). If the user training level is higher, then the Group may be shown only as a single step (using its <code><em>description</em></code>, inherited from <code>PLAN_ITEM</code>); otherwise it may be shown as the set of sub-steps. This provides a simple way for the same Plan to be presented in different forms matching different performer experience levels.</p>
</div>
<div class="paragraph">
<p>The default value of <code><em>training_level</em></code> is 0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_references_to_design_time_artefacts"><a class="anchor" href="#_references_to_design_time_artefacts"></a>6.5.6. References to Design-time Artefacts</h4>
<div class="paragraph">
<p><code>WORK_PLAN</code> and <code>TASK_PLAN</code> contain various references to external artefacts that they are typically based on or relate to, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <code>WORK_PLAN</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code><em>care_plan</em></code>: a reference to a driving Care Plan from elsewhere in the EHR, if any exists;</p>
</li>
<li>
<p><code><em>care_pathway</em></code>: references to a care pathway from which this Task Plan was derived, if any;</p>
</li>
</ul>
</div>
</li>
<li>
<p>In <code>TASK_PLAN</code>:</p>
</li>
<li>
<p><code><em>guideline</em></code>: reference to a published guideline from which this particular Task Plan was derived, if any;</p>
</li>
<li>
<p><code><em>best_practice_ref</em></code>: reference to an institutional document that defines the best practice on which this Task Plan is based, if any;</p>
</li>
<li>
<p><code><em>order_set</em></code>: the identifier of an Order Set which this Task Plan uses, if any;</p>
</li>
<li>
<p><code><em>workflow_id</em></code>: an identifier shared among orders (<code>INSTRUCTIONs</code> and <code>ACTIONs</code>) from the Order Set instance used in this Task Plan, if any.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interaction_with_the_ehr"><a class="anchor" href="#_interaction_with_the_ehr"></a>6.6. Interaction with the EHR</h3>
<div class="sect3">
<h4 id="_versioning_and_ehr_committal"><a class="anchor" href="#_versioning_and_ehr_committal"></a>6.6.1. Versioning and EHR Committal</h4>
<div class="paragraph">
<p>If a <code>WORK_PLAN</code> and its constituent parts is created within a <code>COMPOSITION</code> for committal to the EHR (or a workflow-specific part of the EHR), it may be re-versioned as changes are made to its contents. The causes of change include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>changes to the definition;</p>
</li>
<li>
<p>additions to the execution history, corresponding to each Task or Plan level event, including completion or abandonment of the Task Plan.</p>
</li>
</ul>
</div>
<div class="paragraph tbd">
<p>TBD: review the following para</p>
</div>
<div class="paragraph">
<p>As the <code>TASK_PLAN</code> gets progressively built and executed over time, its owning <code>COMPOSITION</code> will undergo numerous changes, corresponding both to changes to the plan definition, and also execution of the actions performed to fulfill it. Typically only the former will generate new committed versions to the EHR, whereas the latter will most likely only be used by the workflow application during execution of the Task Plan. How changes to Task Plan are versioned and added to the EHR (or not) can be handled flexibly according to local needs.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_task_availability_2"><a class="anchor" href="#_task_availability_2"></a>6.7. Task Availability</h3>
<div class="paragraph">
<p>A workflow application or engine executing a Task Plan can determine the availability for execution of any Task Group or Task as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>control-flow</strong>: check completion status of preceding Tasks / Groups within the current Task Group;</p>
</li>
<li>
<p><strong>timing</strong>: check Task execution time, if set, with respect to current time;</p>
</li>
<li>
<p><strong>validity</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>check that Task wait notifications have been received from related Task Plans executing in the same group;</p>
</li>
<li>
<p>check Task preconditions, assessed by executing precondition expressions against the EHR.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow application may provide an override capability so that a Task can be performed before it is determined to be available. This would enable a user to perform the Task anyway, with the corresponding <code>TASK_EVENT_RECORD</code> recording the use of override.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions_2"><a class="anchor" href="#_class_descriptions_2"></a>6.8. Class Descriptions</h3>
<div class="sect3">
<h4 id="_work_plan_class"><a class="anchor" href="#_work_plan_class"></a>6.8.1. WORK_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>WORK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Top-level object of any logical work plan. References one or more TASK_PLANs that described the work, typically of each performer, although a single TASK_PLAN may also have multiple performers.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">AUTHORED_RESOURCE, CONTENT_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>care_pathway</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of care pathway etc, on which this Work Plan is based, if such exists. A 'care pathway' is understood here as a published standard for performing care for a major condition or presenting complaint, e.g. sepsis, MI etc.</p>
</div>
<div class="paragraph">
<p>It is currently assumed that there is no reliable machine identifier system for care pathways. A DV_IDENTIFIER allows things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>issuer = "NICE";</p>
</li>
<li>
<p>id = "https://pathways.nice.org.uk/pathways/sepsis"</p>
</li>
<li>
<p>type = "NICE Sepsis care pathway"</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plans</strong>: <code>List&lt;UID_BASED_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>care_plan</strong>: <code>LOCATABLE_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Care plan in EHR from which this Work Plan is derived, if any.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>order_list</strong>: <code>List&lt;LOCATABLE_REF&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of orders in this Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-understandable description of the Task Plan, which may be specific to the work items and patient.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_plan_class"><a class="anchor" href="#_task_plan_class"></a>6.8.2. TASK_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Logical list of Tasks in a structure defining order and conditions of execution of items of work intended to achieve a goal. A Task Plan consists of a top-level TASK_GROUP containing PLAN_ITEMs, which are either atomic TASKs, more TASK_GROUPs or DECISION nodes.</p>
</div>
<div class="paragraph">
<p>A Task Plan specifies a principal_performer, representing a kind of actor who can perform the Tasks, and bounding start_time and completion_time information.</p>
</div>
<div class="paragraph">
<p>It has an associated execution_history that can be used to record work events in time.</p>
</div>
<div class="paragraph">
<p>The attributes care_plan and guideline_id provide a way of associating a Task Plan with an operational care plan, and also a published guideline or protocol on which the Task Plan may be based.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LOCATABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-understandable description of the Task Plan, which may be specific to the work items and patient.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>subject</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional indicator of subject of Task, which is normally the subject of the EHR. If this is not the case, this attribute states who the Task is to be performed on.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>guideline</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of guideline on which this Task Plan is based, if such exists. A 'guideline' is understood here as a published standard for performing a detailed Task.</p>
</div>
<div class="paragraph">
<p>It is currently assumed that there is no reliable machine identifier system for guidelines. A DV_IDENTIFIER allows things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>issuer = "NICE";</p>
</li>
<li>
<p>id = "https://www.nice.org.uk/guidance/cg180"</p>
</li>
<li>
<p>type = "NHS guideline for Atrial fibrillation: management"</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The Tasks for the main part of this Task Plan; this section of the plan may be repeatable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_history</strong>: <code>TASK_PLAN_EXECUTION_HISTORY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>History of execution events for an execution of this Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>best_practice_ref</strong>: <code>DV_URI</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A URI (typically a local URL) that points to the document form of any governing guideline or other best practice publication in use in the current institution. This link provides a way for a clinician to cross-check the Task Plan design and functioning against the definitive document that acts as the source of its semantics.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expiry_time</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Maximal date/time by which this Task Plan should be considered obsolete. If not set, the Task Plan would normally be inferred to be obsolete after a discharge from acute care, but in primary or social care situations, no value may be assumed to indicate that the Tasks are still to be performed, depending on the times specified in the execution_time attribute of TASKs in the plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>due_time</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Due date/time expressed as an offset, to be converted to a real date/time at activation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>order_set</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional identifier for an order set, which is understood as a <em>type</em> of order set, e.g. 'R-CHOP-14'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>workflow_id</strong>: <code>OBJECT_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of instance of order set from which this Task Plan is drawn, if there is one. Should match the workflow_id in all INSTRUCTION and other ENTRY instances created due to the same order set instance.</p>
</div>
<div class="paragraph">
<p>TODO: needed?</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>context</strong>: <code>PLAN_DATA_CONTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>indications</strong>: <code>List&lt;DV_TEXT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Clinical applicability of this Task item to subject of work, e.g. 'pregnancy', 'lymphoma' etc. May be derived from a governing guideline. May be displayed as a safety precaution to human performer.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_participation_class"><a class="anchor" href="#_task_participation_class"></a>6.8.3. TASK_PARTICIPATION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PARTICIPATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Class defining a participation in Task(s), minimally in terms of function. Optionally, the role and mode may also be specified. The performer attribute enables a specific actor to be specified.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>function</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The function of the Party in this participation (note that a given party might participate in more than one way in a particular activity). This attribute should be coded, but cannot be limited to the HL7v3:ParticipationFunction vocabulary, since it is too limited and hospital-oriented.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>role</strong>: <code>List&lt;DV_TEXT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Organisational role, i.e. the professional type of participant in the activity. Preferably coded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mode</strong>: <code>DV_CODED_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional field for recording the 'mode' of the performer / activity interaction, e.g. present, by telephone, by email etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>performer</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The id and possibly demographic system link of the party participating in the activity.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optionality</strong>: <code>VALIDITY_KIND</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition for participation in the Plan item.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_plan_item_class"><a class="anchor" href="#_plan_item_class"></a>6.8.4. PLAN_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>PLAN_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Parent type of all item types that may appear within a Task Plan structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LOCATABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>item_id</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Integer indicating the ordinal number of this Task within its Task group. Used for referencing from other objects. Required to be unique with respect to other siblings in the same Task group.</p>
</div>
<div class="paragraph">
<p>Identification of any Task in a Task Plan is done using paths of the form /task_group_id/task_group_id.</p>
</div>
<div class="paragraph">
<p>TODO: needed?</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-readable form of the task directive.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_item_class"><a class="anchor" href="#_task_item_class"></a>6.8.5. TASK_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TASK_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent type of the Task definition types TASK_GROUP and TASK.</p>
</div>
<div class="paragraph">
<p>Supports definition of optionality, pre-conditions, wait conditions, indications and notifications with any Task Group or Task.</p>
</div>
<div class="paragraph">
<p>Provides a place to record fine-grained costing data.</p>
</div>
<div class="paragraph">
<p>Informal other participations can also be recorded for any Task Group or Task, although these do not replace the Task Plan principal_performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_participations</strong>: <code>List&lt;TASK_PARTICIPATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of participations for task item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>costing_data</strong>: <code>TASK_COSTING</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Costing data related to this Task item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions</strong>: <code>List&lt;TASK_PRECONDITION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition which must be met for the TASK_ITEM to be available to perform in a runtime execution context.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Archetypable structure for recording non hard-modelled information.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_time</strong>: <code>TIMING_SPEC</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional specifier of time at which the Task of Task Group should be performed. If not provided, the Task is assumed to be available to perform immediately following completion of the previous members of the parent Task Group.</p>
</div>
<div class="paragraph">
<p>The Task may be performed earlier or later than this time; it is understood as a guide only.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_precondition_class"><a class="anchor" href="#_task_precondition_class"></a>6.8.6. TASK_PRECONDITION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PRECONDITION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Conditions expressing when the Task is executable with respect to the principal performer and subject.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Textual representation of preconditions for this Task to be performed, according to governing protocol. May be displayed as a safety check for human performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expression</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>In the case that required_status /= mandatory; a Boolean expression that can be evaluated at runtime to determine inclusion.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_timing_spec_class"><a class="anchor" href="#_timing_spec_class"></a>6.8.7. TIMING_SPEC Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TIMING_SPEC (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Parent of classes representing ways to specify time of an action to be performed.</p>
</div>
<div class="paragraph tbd">
<p>TODO: probably need an option for coded times like 'afternoon', 'midday' etc.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-generic-planned_time: These classes should probably be made generic and added to the BASE component. Needs to take into account some of the other models of time specification. See e.g. openEHR-EHR-CLUSTER.timing_daily.v0.0.1 for other design concepts.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_window</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time window after an initial time during which the action should start. Allows for approximate times to be used operationally.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_clock_timing_class"><a class="anchor" href="#_clock_timing_class"></a>6.8.8. CLOCK_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CLOCK_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents a time at which a single future event or action should take place in terms of an offset from an origin.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_offset</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time at which the action should start, specified as an offset from the Task Plan origin time.  The effective real time to start operationally can be computed from an absolute origin time plus this offset.</p>
</div>
<div class="paragraph">
<p>If start_window is set, the action may start within this a certain duration after the start_offset.</p>
</div>
<div class="paragraph">
<p>If set, relative_offset and relative_time_qualifier are not set.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_event_linked_timing_class"><a class="anchor" href="#_event_linked_timing_class"></a>6.8.9. EVENT_LINKED_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_LINKED_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents a time at which a single future event or action should take place in terms of a real world event such as 'meal', a relative ordering with respect to the event, e.g. 'before', and an optional time offset, e.g. 3h. This allows time specifications like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>with (at) sleep time</p>
</li>
<li>
<p>3h before</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_offset</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Relative time offset with respect to origin nominated in relative_time_qualifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_type</strong>: <code>DV_CODED_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Indicates that the action should be aligned with a real world event. Typical values: meal, evening meal, sleep, toilet.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_order</strong>: <code>TEMPORAL_RELATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Order of event_offset with respect to event_type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_temporal_relation_enumeration"><a class="anchor" href="#_temporal_relation_enumeration"></a>6.8.10. TEMPORAL_RELATION Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TEMPORAL_RELATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration of relative temporal relations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">before</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Before a reference event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">with</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>At the same time as a reference event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">after</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>After a reference event.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_linked_timing_class"><a class="anchor" href="#_task_linked_timing_class"></a>6.8.11. TASK_LINKED_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_LINKED_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents a time at which a single future event or action should take place in terms of a time relative to completion of another Task or other task-related event.</p>
</div>
<div class="paragraph tbd">
<p>Need to specify this better.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>reference_item</strong>: <code>TIMING_REFERENCE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Indicates what time origin to use for this action in terms of other actions. May take values such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>after_previous: after the previous action in a list, by the offset duration if any;</p>
</li>
<li>
<p>after_start: after the start of the list, by the offset duration if any.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>relative_offset</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Relative time offset with respect to origin nominated in relative_time_qualifier.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_state_linked_timing_class"><a class="anchor" href="#_state_linked_timing_class"></a>6.8.12. STATE_LINKED_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>STATE_LINKED_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Timing specified relative to subject state, e.g. vital sign value.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>condition</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition that when true</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test_period</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time period to delay and then retest condition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_timing_reference_enumeration"><a class="anchor" href="#_timing_reference_enumeration"></a>6.8.13. TIMING_REFERENCE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TIMING_REFERENCE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration of types of temporal reference within a Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">previous_task</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The previous task in a series of tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_group</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The start time of the current group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_group_class"><a class="anchor" href="#_task_group_class"></a>6.8.14. TASK_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Grouping structure that defines the execution basis for a collection of Tasks, which may include more Task groups.</p>
</div>
<div class="paragraph">
<p>The execution_type attribute defines the mode of execution. If not set, sequential execution is assumed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of Tasks to perform. Sequencing is either the natural order of the tasks list, or may be controlled by</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_type</strong>: <code>EXECUTION_TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Basis for executing the Task items contained in this Task Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>principal_performer</strong>: <code>TASK_PARTICIPATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specification of principle performer of this Task Plan as a Participation, in terms of role and optionally function, mode and specific performer as appropriate.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>repeat_spec</strong>: <code>TASK_REPEAT</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>training_level</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An integer value representing the training level for which this Task Plan is designed. A high value corresponds to a lower level of expertise. The default value is zero.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_repeat_class"><a class="anchor" href="#_task_repeat_class"></a>6.8.15. TASK_REPEAT Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_REPEAT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Definition of repetition for a Task Group. The repeats attribute provides a constraint on a number of times. If not set, any number of repeats is allowed. The terminate_condition attribute defines when repetition should cease in terms of a condition, typically a subject-related variable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>repeats</strong>: <code>Interval&lt;Integer&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Range of repetitions. If the lower limit is greater than zero, at least one repeat is required. A range such as 0..3 means up to 3 repeats possible, but not required.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>terminate_condition</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>States a condition for when repetition should stop.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_decision_group_class"><a class="anchor" href="#_decision_group_class"></a>6.8.16. DECISION_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised node that represents a decision point in guideline-based Task Plan definition. The decision is represented by the value_expression, which at runtime is instantiated as an ASSIGNMENT.</p>
</div>
<div class="paragraph">
<p>Instances of this class also act as a container for the subordinate decision paths which are modelled as TASK_GROUPs with execution_type = decisional, and each having a precondition representing a match expression for the value generated by the value_expression on the parent DECISION_GROUP object.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value_expression</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An expression in the form of a variable assignment from an expression or a plain variable reference, if no expression is required. The same variable will appear in the test_expressions of all immediate child paths. Each of these expressions must have mutually exclusive value ranges to be valid.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>paths</strong>: <code>List&lt;DECISION_PATH_GROUP&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of Task Groups that are also decision paths in this Decision Group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_decision_path_group_class"><a class="anchor" href="#_decision_path_group_class"></a>6.8.17. DECISION_PATH_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_PATH_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised kind of TASK_GROUP that corresponds to a particular decision path branch from a DECISION_GROUP.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK_GROUP</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test_expression</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A test expression on a variable whose value is defined by the value_expression attribute of the owning DECISION_GROUP. Must be a mutually exclusive value range with respect to sibling DECISION_PATH_GROUPs.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_execution_type_enumeration"><a class="anchor" href="#_execution_type_enumeration"></a>6.8.18. EXECUTION_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXECUTION_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration specifying types of execution for a set of Tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequential</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items execute in order, one after the other.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items may be executed in parallel, with no regard to order in the representation.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_class"><a class="anchor" href="#_task_class"></a>6.8.19. TASK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TASK (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of various types of planned Task, which may be real work items (DEFINED_TASK) or references to another Task Plan (EXTERNAL_PLAN).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>instruction_activity</strong>: <code>LOCATABLE_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional reference back to the ACTIVITY of an INSTRUCTION that generated this TASK.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_linked_plan_class"><a class="anchor" href="#_linked_plan_class"></a>6.8.20. LINKED_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>LINKED_PLAN (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task type that represents a dispatch to another Task Plan to be executed by another performer in a Plan Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>target</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>UID of target TASK_PLAN object.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_sub_plan_class"><a class="anchor" href="#_sub_plan_class"></a>6.8.21. SUB_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SUB_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A Task referencing another Plan within the same Work Plan, to be executed by the current performer. Execution continues on from the previous Task.</p>
</div>
<div class="paragraph">
<p>For an experienced performer, the referenced Plan, which is usually more detailed may not be needed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LINKED_PLAN</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_hand_off_class"><a class="anchor" href="#_hand_off_class"></a>6.8.22. HAND_OFF Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>HAND_OFF</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A kind of Task representing a hand-off to a different performer in the current Work Plan.</p>
</div>
<div class="paragraph">
<p>Tasks of the linked Plan become available to that performer, who is also alerted to start work.</p>
</div>
<div class="paragraph">
<p>A hand-off usually involves waiting with later notification (callback), or continuation. Waiting would typically mean the Plan execution engine places this Plan on a wait list, enabling the performer to proceed with work on other subjects.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LINKED_PLAN, DISPATCHABLE</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_external_request_class"><a class="anchor" href="#_external_request_class"></a>6.8.23. EXTERNAL_REQUEST Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXTERNAL_REQUEST</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task type for representing a request to an external organisational service or actor not within the current Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK, DISPATCHABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>organisation</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of organisation to which the request or order is addressed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>request_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Request details.</p>
</div>
<div class="paragraph">
<p>TODO: more details needed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_system_request_class"><a class="anchor" href="#_system_request_class"></a>6.8.24. SYSTEM_REQUEST Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SYSTEM_REQUEST</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Request to an external system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK, DISPATCHABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_call</strong>: <code>SYSTEM_CALL</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_defined_task_class"><a class="anchor" href="#_defined_task_class"></a>6.8.25. DEFINED_TASK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DEFINED_TASK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task sub-type that represents concretely defined work items. The definition of the work of the Task is expressed in terms of archetype of an ENTRY (usually an ACTION) that will be used to record the Task&#8217;s execution.</p>
</div>
<div class="paragraph">
<p>The entry_instance attribute can be used to record a forward reference to an ACTION or other ENTRY when it has been recorded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>prototype</strong>: <code>List&lt;ENTRY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Prototype instance of one or more Entries that express the specific work of the Task. Normally one Entry would be used, typically an ACTION, but more than one may sometimes make sense, e.g. an ACTION and an OBSERVATION.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>review_dataset</strong>: <code>List&lt;DATASET_SPEC&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional data-set to review prior to / as part of performing Task. This implies a data retrieval from the EHR or other system, which may be specified using a SYSTEM_REQUEST attached to this Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>capture_dataset</strong>: <code>List&lt;DATASET_SPEC&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Associated data-set template and/or form via which data to be captured during this Task will actually be entered.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optionality</strong>: <code>VALIDITY_KIND</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Informal indication of whether Task is considered optional or not from the point of view of any guideline. If not set, the Task is treated as mandatory.</p>
</div>
<div class="paragraph">
<p>TODO: is this useful or meaningful, since it can change</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dataset_spec_class"><a class="anchor" href="#_dataset_spec_class"></a>6.8.26. DATASET_SPEC Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DATASET_SPEC</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Specification of a related data-set and/or form to use with a Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>form_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Form identifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>template_id</strong>:</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Template identifier. If used with no form_id, the Execution engine needs to determine how to find a form based on the template identifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other data-set related details.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_execution_model"><a class="anchor" href="#_task_execution_model"></a>7. Task Execution Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>7.1. Overview</h3>
<div class="paragraph">
<p>The following figure shows the execution related parts of the <code>rm.task_planning</code> package. The consists of two parts: the <em>materialised</em> representation, and the <em>execution history</em> part. The former is a partial specification of classes that could be instantiated at Task Plan execution time to track Plan execution, and is provided as a guide to how execution tracking can be done. The latter classes describe the execution history after the fact, in the form of <em>event records</em> that can optionally be stored in the EHR after Task Plan execution has completed.</p>
</div>
<div id="rm_task_planning_execution" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning-execution.svg" alt="RM task planning execution">
</div>
<div class="title">Figure 19. rm.task_planning package - execution model</div>
</div>
<div class="paragraph">
<p>As described in <a href="#_execution_semantics">Execution Semantics</a>, Plan execution traverses three states: <code>materialised</code>, <code>activated</code> and <code>terminated</code>, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>materialised</code> state: at any time after creation of the materialised Plan from its definition form, the following actions are possible:</p>
<div class="ulist">
<ul>
<li>
<p>Various changes can be made to the materialised structure, as long as they do not violate the constraints on the definition;</p>
</li>
<li>
<p>Connection to a notification push-channel must be made for every principal participant and external system mentioned in the Plan definition; these channels do not have to be all different (i.e. multiple parties may be communicated with via a single channel that talks to say a ward screen).</p>
</li>
<li>
<p>Advance allocations of Tasks to concrete participants may be made in this phase;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>activated</code> state: the materialised Plan is <em>activated</em> at some point in time after creation.</p>
<div class="ulist">
<ul>
<li>
<p>This establishes the zero point of the execution clock, and will cause various kinds of notifications to occur as time moves forward.</p>
</li>
<li>
<p>The execution system then creates notifications through the various channels to indicate Tasks to be executed for each type of performer.</p>
</li>
<li>
<p>Where performers are already allocated, they may commence work and indicate back to the system the state of each Task as it proceeds through its lifecycle (below).</p>
</li>
<li>
<p>For Tasks that are not yet allocated, a notification soliciting an acceptance is posted when this is responded to by a user, work begins.</p>
</li>
<li>
<p>During the work, Tasks become <em>available</em> (see below) as earlier Tasks are completed or cancelled. When a Task is available to be done, the performer has various options, including doing the work, cancelling the Task as not needed, completing the Task, aborting it, and abandoning the entire Plan.</p>
</li>
<li>
<p>As the work proceeds, event records are generated and added to the execution history.</p>
</li>
<li>
<p>The Plan remains in the active state until abandoned or completed.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>terminated</code> state: A Plan terminates when a path taken through the materialised Task graph terminates, either due to finishing, or due to abandonment at an intermediate Task.</p>
<div class="ulist">
<ul>
<li>
<p>The Plan as a whole returns a termination status of success or fail, which may be used to control behaviour if it is part of a handover chain in which a context switch follows termination.</p>
</li>
<li>
<p>A final event record is added to the execution history.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>During a long-running Task Plan, the principal performer may change. This will usually be the case for Task Plans that run longer than a work shift.</p>
</div>
</div>
<div class="sect2">
<h3 id="_materialisation"><a class="anchor" href="#_materialisation"></a>7.2. Materialisation</h3>
<div class="paragraph">
<p>When a Work Plan is to be executed, it will be materialised. Some user input may be required, e.g. number of repetitions of repeatable sections. The materialised representation consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A copy of the definition form of the Plan;</p>
</li>
<li>
<p>An instance of the Plan using Materialised model instances, i.e. the <code>M_XXX</code> classes, representing the concrete executable Tasks, each with a reference back to a definition Task. For Plans with repeatable sections, the Materialised model contains these sections 'unrolled' into as many instances as required by the Plan activator. Thus, more than one <code>M_TASK</code> may point to the same generating <code>TASK</code> from the definition form.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The structure created will this mirror the structure of the original definition, with extra copies for repeatable sections. That is to say, <code>M_TASK_GROUP</code> instances will have <code><em>members</em></code> containing further <code>M_XX</code> instances, that mimic the <code>TASK_GROUP</code> structures within the Plan definition.</p>
</div>
<div class="paragraph tbd">
<p>TBD: Structural modifications</p>
</div>
<div class="ulist">
<ul>
<li>
<p>alter repeating section repeats</p>
</li>
<li>
<p>remove decision branches and Tasks whose conditions will never be met</p>
</li>
</ul>
</div>
<div class="paragraph tbd">
<p>TBD: Connection setup</p>
</div>
<div class="paragraph tbd">
<p>TBD: Allow pre-allocations</p>
</div>
</div>
<div class="sect2">
<h3 id="_activation"><a class="anchor" href="#_activation"></a>7.3. Activation</h3>
<div class="paragraph">
<p>A materialised Plan is activated when it is ready to be used. Activation 'starts the clock'; accordingly, the <code>M_TASK_PLAN</code> attribute <code><em>start_time</em></code> is set to the current time. Execution times in the Plan are converted to absolute clock times, or a form that can be related to clock time.</p>
</div>
<div class="paragraph">
<p>The materialised form of the detailed structure of the plan may be instantiated fully, or only partially, where convenient. For example, if most of the plan has been completed, and only some steps remain, it may make sense to instantiate only the <code>M_XX</code> instances corresponding to those steps. On the other hand, an applicaiton may want to display the details of the whole plan, even when only a small part remains to be executed.</p>
</div>
<div class="paragraph">
<p>When the structure creation has been completed, the <code><em>lifecycle_state</em></code> attribute of one or more <code>M_TASK</code> instances may be set to <code>available</code>, or if picking up from a previous session, to other states (i.e. <code>completed</code> etc), as appropriate.</p>
</div>
<div class="paragraph">
<p>At materialisation time, an instance of <code>EXECUTION_HISTORY</code> is also created, proving a root point to accumulate Task Plan execution event records.</p>
</div>
</div>
<div class="sect2">
<h3 id="_termination"><a class="anchor" href="#_termination"></a>7.4. Termination</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_time_semantics"><a class="anchor" href="#_execution_time_semantics"></a>7.5. Execution Time Semantics</h3>
<div class="sect3">
<h4 id="_allocation_and_re_allocation"><a class="anchor" href="#_allocation_and_re_allocation"></a>7.5.1. Allocation and re-allocation</h4>
<div class="paragraph">
<p>Before a materialised Task Plan can be executed, the <code><em>principal_performers</em></code> of its <code>TASK_GROUPs</code> must be <em>allocated</em> to real actors. This is done by user(s) authenticating to the Plan execution engine and signing up for specific roles and functions within the Plan. Not all performers are needed at any time, only those implicated in some defined part of the Plan to be executed, e.g. for the current day within a multi-day Plan.</p>
</div>
<div class="paragraph">
<p>At various moments during the execution of a Plan, a performer may leave and be replaced by another performer, e.g. due to worker shift changeover. This requires a de-allocation of the leaving performer from the Plan and a new allocation of a new actor.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_lifecycle_model"><a class="anchor" href="#_task_lifecycle_model"></a>7.5.2. Task Lifecycle Model</h4>
<div class="paragraph">
<p>During execution, each Task is represented by an instance of <code>M_TASK</code> that refers back to its <code>TASK</code> definition instance. Each Task in the Plan has a lifecycle consisting of various states it may pass through in time. Changes in the lifecycle are recorded in <code>M_TASK.<em>lifecycle_state</em></code>. The lifecycle is simple, since it only has to take account of the states a Task itself can pass through - states of any order with which the Task may be associated will be visible in the documentation of the Task execution, i.e. separate openEHR <code>ACTION</code> or other Entry objects. The states are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initial</code>: initial pseudo-state, not used in operation;</p>
</li>
<li>
<p><code>planned</code>: defined, but not yet available for execution;</p>
</li>
<li>
<p><code>available</code>: available for execution, due to previous Tasks having been performed, preconditions being met, and if there is a time specification on the Task, the current time being at or later than the stated time;</p>
</li>
<li>
<p><code>cancelled</code> (T): cancelled prior or during execution as not needed for success of the Plan;</p>
</li>
<li>
<p><code>completed</code> (T): performed to completion;</p>
</li>
<li>
<p><code>abandonned</code> (T): execution was stopped before or after commencement due to completion being impossible.;</p>
</li>
<li>
<p><code>underway</code>: indicates that a Task execution has been commenced;</p>
</li>
<li>
<p><code>suspended</code>: indicates that a Task execution has been suspended.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the above, the terminal states are marked with '(T)'. The state machine is shown below.</p>
</div>
<div id="task_state_machine" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-TaskStateMachine.svg" alt="RM TaskStateMachine" width="60%">
</div>
<div class="title">Figure 20. Task lifecycle state machine</div>
</div>
<div class="paragraph">
<p>A key feature of the state model is that the terminal states determine whether the Plan exeuction continues or not: if the <code>abandonned</code> state is entered, it does not.</p>
</div>
<div class="paragraph">
<p>The state machine is primarily designed to allow a stateless view of the actual execution state of a Task. That is to say, the standard pathway is <code>available</code> &#8658; <code>completed</code> or <code>abandonned</code> or <code>cancelled</code>, which enables a user to indicate the outcome of executing a Task, but not interim states during execution. The pathways through the states <code>underway</code> and <code>suspended</code> are provided to represent in-execution states if needed, typically for longer-running atomic Tasks.</p>
</div>
<div class="paragraph">
<p>It may be that one or more Tasks do not evaluate to <code>available</code> at runtime when the principal performer wants to treat them as being available. This may happen if the performer wants to execute a Task earlier than scheduled, or decides that an unmet precondition or wait condition does not matter (for example, they may know that it is met, but the Task Plan application may not yet know). Accordingly, a user override can be used, represented by the override pathway from <code>planned</code> &#8658; <code>available</code>.</p>
</div>
<div class="paragraph">
<p>Since a Task Plan is a hierarchical structure consisting of one or more Task Groups, a way of rolling up Task state is needed. The following algorithm is used to compute the effective lifecycle state of a <code>M_TASK_GROUP</code> from the set of states of its members (which may include other <code>M_TASK_GROUPs</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-c1">//</span>
<span class="tok-c1">// Infer the state of a collection whose members have states in sourceStates.</span>
<span class="tok-c1">// The order of if/else evaluation determines the correct result.</span>
<span class="tok-c1">//</span>
<span class="tok-n">TaskState</span> <span class="tok-nf">inferredState</span> <span class="tok-o">(</span><span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">TaskState</span><span class="tok-o">&gt;</span> <span class="tok-n">sourceStates</span><span class="tok-o">)</span> <span class="tok-o">{</span>

    <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Abandonned</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Abandonned</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Available</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Available</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Planned</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Planned</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Completed</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Completed</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Suspended</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Suspended</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Suspended</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Suspended</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Cancelled</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Cancelled</span><span class="tok-o">;</span>
    <span class="tok-k">else</span>
        <span class="tok-k">return</span> <span class="tok-n">Initial</span><span class="tok-o">;</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the runtime Task Group is also the top-level structure of the runtime Task Plan, the inferred state of the Plan as a whole is also provided by this algorithm applied to the top-level runtime Task Group.</p>
</div>
</div>
<div class="sect3">
<h4 id="_notifications"><a class="anchor" href="#_notifications"></a>7.5.3. Notifications</h4>
<div class="paragraph">
<p>Notifications can be specified to be generated at various lifecycle state changes.</p>
</div>
<div class="paragraph tbd">
<p>To be continued</p>
</div>
</div>
<div class="sect3">
<h4 id="_persistence"><a class="anchor" href="#_persistence"></a>7.5.4. Persistence</h4>
<div class="paragraph">
<p>The run-time instance structure may need to be persisted to enable a partial execution of a long-running Task Plan to be recorded and picked up when later tasks become ready. In theory, this could be within the EHR, but it is recommended that either a specific EHR area be used for this, or that run-time state persistence be implemented outside the EHR proper.</p>
</div>
<div class="paragraph tbd">
<p>issue-runtime-persistence: if within the EHR, we could create a new 'pointer' on the EHR object that points to 'task runtime state' data or similar. Is this a useful thing to do?</p>
</div>
</div>
<div class="sect3">
<h4 id="_context_switching"><a class="anchor" href="#_context_switching"></a>7.5.5. Context Switching</h4>
<div class="paragraph tbd">
<p>TBD: describe context switch for hand-off, external requests etc.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions_3"><a class="anchor" href="#_class_descriptions_3"></a>7.6. Class Descriptions</h3>
<div class="sect3">
<h4 id="_m_task_plan_class"><a class="anchor" href="#_m_task_plan_class"></a>7.6.1. M_TASK_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Root object of a materialised Task Plan structure, used in execution.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Nominal start time for the Task Plan as a whole. The timings of individual Tasks may be specified as offsets from this time, via PLANNED_TIME.relative_offset.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>M_TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Root of run-time Task Plan Task structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>owner</strong>: <code>TASK_PLAN</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Owning Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pending_callbacks</strong>: <code>List&lt;M_CALLBACK&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of all wait conditions in the Task Plan, and current status.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>context</strong>: <code>M_PLAN_DATA_CONTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Lifecycle state of Task Plan, derived as a copy of the lifecycle_state() of the definition TASK_GROUP.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_plan_data_context_class"><a class="anchor" href="#_m_plan_data_context_class"></a>7.6.2. M_PLAN_DATA_CONTEXT Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_PLAN_DATA_CONTEXT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>PLAN_DATA_CONTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Definition object for this execution time context.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_callback_class"><a class="anchor" href="#_m_callback_class"></a>7.6.3. M_CALLBACK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_CALLBACK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Class representing the runtime tracked form of a callback for currently blocked tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_item</strong>: <code>M_TASK</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to the Task Item blocked waiting on this callback.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dispatch_info</strong>: <code>DISPATCHABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Dispatch object defining actions on receipt of callback.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_plan_item_class"><a class="anchor" href="#_m_plan_item_class"></a>7.6.4. M_PLAN_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>M_PLAN_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of materialised run-time types that correspond to design time PLAN_ITEM instances.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_participations</strong>: <code>List&lt;M_ALLOCATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time participations of this Plan Item in addition to principal performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>PLAN_ITEM</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Corresponding item from Task Plan definition. Redefined in descendants to the definition type corresponding to each runtime (RT_XXX) type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_item_class"><a class="anchor" href="#_m_task_item_class"></a>7.6.5. M_TASK_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>M_TASK_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of materialised run-time types that correspond to design time TASK_ITEM instances.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">M_PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_ITEM</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK_ITEM instance in Task Plan definition. Redefined in descendants.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_group_class"><a class="anchor" href="#_m_task_group_class"></a>7.6.6. M_TASK_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised run-time homologue of TASK_GROUP from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">M_TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;M_PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Member run-time items in group, mimicking structure of the corresponding definition group instance.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>principal_performer</strong>: <code>M_ALLOCATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time principal performer - a person or other agent.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Effective lifecycle state, computed from the states of members of the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_class"><a class="anchor" href="#_m_task_class"></a>7.6.7. M_TASK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised run-time homologue of TASK type and its descendants from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">M_TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Current lifecycle state of this Task at run-time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>events</strong>: <code>List&lt;TASK_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of references to run-time events that have occurred on this Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions</strong>: <code>List&lt;ASSERTION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time form of preconditions on corresponding TASK in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK instance in Task Plan definition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_decision_group_class"><a class="anchor" href="#_m_decision_group_class"></a>7.6.8. M_DECISION_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_DECISION_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised run-time homologue of DECISION_GROUP from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">M_PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value_expression</strong>: <code>ASSIGNMENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Runtime form of value_expression from ask Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>DECISION_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding DECISION_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>paths</strong>: <code>List&lt;M_DECISION_PATH_GROUP&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Decision path groups, computed by following definition link to the corresponding DECISION_GROUP object in Task Plan definition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_decision_path_group_class"><a class="anchor" href="#_m_decision_path_group_class"></a>7.6.9. M_DECISION_PATH_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_DECISION_PATH_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised run-time homologue of DECISION_PATH_GROUP from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">M_TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test_expression</strong>: <code>ASSERTION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Runtime form of test_expression from ask Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>DECISION_PATH_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding DECISION_PATH_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Effective lifecycle state, computed from the states of members of the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_allocation_class"><a class="anchor" href="#_m_allocation_class"></a>7.6.10. M_ALLOCATION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_ALLOCATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>performer</strong>: <code>PARTY_IDENTIFIED</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>connection</strong>: <code>URI</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>URI used to connect to performer (e.g. application, messaging channel) for notifications.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_task_plan_execution_history"><a class="anchor" href="#_task_plan_execution_history"></a>7.7. Task Plan Execution History</h3>
<div class="paragraph">
<p>The history of execution events is represented in the runtime instance of <code>EXECUTION_HISTORY</code>. This is a history of real world execution events that accumulates over the duration of processing of the Task Plan. Two types of event are used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TASK_EVENT_RECORD</code>: type representing a change to one consitutent Task. Thus, if the performer cancels a particular Task within the list, a <code>TASK_EVENT_RECORD</code> will be added to the history, including Task id, time, and reason; notifications can also be recorded on such events;</p>
</li>
<li>
<p><code>TASK_PLAN_EVENT_RECORD_</code>: type representing any kind of execution event not linked to a specific Task, for example 'plan abandonment', 'new principal performer'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first type may also include forward references to EHR Entries that were committed as a result of a Task being performed. This facilitates logical indexing of planned and performed work items.</p>
</div>
<div class="paragraph">
<p>The Execution history will clearly grow and might become quite long for some Task Plan executions. How it may be persisted in various ways. The following possibilities are all compatible with both the model, and typical EHR requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Task Plan application persistence:</p>
<div class="ulist">
<ul>
<li>
<p>persist the full history, delete or archive once the Task Plan is fully completed;</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the EHR:</p>
<div class="ulist">
<ul>
<li>
<p>persist the full history in some or all cases, if useful in the EHR environment (e.g. for teaching);</p>
</li>
<li>
<p>persist a partial / filtered version of the history, e.g. retain only <em>cancel</em> and <em>abort</em> events, on the basis that completed Tasks will show up as <code>ACTIONs</code> elsewhere in the EHR;</p>
</li>
<li>
<p>don&#8217;t persist any of the history - rely on the workflow application persistence for it during execution, and forget afterward.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This approach cleanly separates the definitional representation of a Task Plan, which should only change if changes to the plan are made, and the execution state, which is built during the work performance.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_4"><a class="anchor" href="#_class_descriptions_4"></a>7.7.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_plan_execution_history_class"><a class="anchor" href="#_task_plan_execution_history_class"></a>7.7.1.1. TASK_PLAN_EXECUTION_HISTORY Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN_EXECUTION_HISTORY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>History of Task Plan execution events and notifications. May be used by a workflow application to record all events during execution.</p>
</div>
<div class="paragraph">
<p>May be persisted in the EHR in partial or complete form, or not at all.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_events</strong>: <code>List&lt;TASK_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task-level execution time events.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plan_events</strong>: <code>List&lt;TASK_PLAN_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Execution time events that occurred at the Task Plan level, i.e. not to a particular task. These include events such as Task Plan abandonment.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_event_record_class"><a class="anchor" href="#_event_record_class"></a>7.7.1.2. EVENT_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EVENT_RECORD (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of types representing execution time events on a Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time the event occurred.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional description associated with the event. Would typically be populated for Cancel and Abort events.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_plan_event_record_class"><a class="anchor" href="#_task_plan_event_record_class"></a>7.7.1.3. TASK_PLAN_EVENT_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN_EVENT_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of an runtime event to a Task Plan, including abandonment, performer allocation and re-allocation and so on.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">EVENT_RECORD</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other details as a name/value list.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_event_record_class"><a class="anchor" href="#_task_event_record_class"></a>7.7.1.4. TASK_EVENT_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_EVENT_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of an event for a single Task. Records task identifier, time, resulting lifecycle state and optional reason.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">EVENT_RECORD</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identification of Task in the Task Plan structre using a path of the form /task_group_id/task_group_id.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The lifecycle state that was reached due to this event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>notifications_sent</strong>: <code>List&lt;TASK_NOTIFICATION_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Notifications that were performed as part of this Task Event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entry_instances</strong>: <code>List&lt;LOCATABLE_REF&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Forward references to Entry (e.g. ACTION, OBSERVATION etc) that was recorded as a result of this Task being performed. If this is set, it indicates that the planned Task is 'done' i.e. checked off the plan.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-fwd-refs: entry_instance is a forward reference - which requires updating the Task Plan after the Tasks have beed performed and relevant Entries committed. Is this complication worth the benefit obtained, i.e. directly followable links rather than querying, to find Entries from the Task Plan items? Is being able to determine the resulting Entries starting from the Task Plan even useful?</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions_satisfied</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set to True if all preconditions defined on the corresponding Task were satisfied at runtime. If set to False, and there were preconditions, this means that preconditions were overridden by the user at runtime.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait_conditions_satisfied</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set to True if all wait_conditions for the corresponding Task were satisfied when it was performed. If False, and there were wait_conditions, wait_conditions were overridden by the user at runtime.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_transition_reason</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Additional reason for lifecycle</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_notification_record_class"><a class="anchor" href="#_task_notification_record_class"></a>7.7.1.5. TASK_NOTIFICATION_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_NOTIFICATION_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of a notification to another party (i.e. performer).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>reciever</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identification of the receiver party</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>receiver_task_plan</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of receiving Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other details as a name/value list.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cost_tracking"><a class="anchor" href="#_cost_tracking"></a>7.8. Cost Tracking</h3>
<div class="paragraph tbd">
<p>TBD: describe cost tracking.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_5"><a class="anchor" href="#_class_descriptions_5"></a>7.8.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_costing_class"><a class="anchor" href="#_task_costing_class"></a>7.8.1.1. TASK_COSTING Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_COSTING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Costing information for a Task.</p>
</div>
<div class="paragraph tbd">
<p>TODO: to be developed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transactional_micro_service"><a class="anchor" href="#_transactional_micro_service"></a>7.9. Transactional Micro-service</h3>
<div class="paragraph">
<p>The information structures required to represent planned Tasks and references at runtime are likely to be non-trivial. For this reason, a Micro-service is defined, with a transactional interface that converts transactional calls to correct underlying information structures.</p>
</div>
<div class="paragraph tbd">
<p>TBC:</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_6"><a class="anchor" href="#_class_descriptions_6"></a>7.9.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_planning_ms_interface"><a class="anchor" href="#_task_planning_ms_interface"></a>7.9.1.1. TASK_PLANNING_MS Interface</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLANNING_MS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task planning micro-service: a service that knows how to create and maintain correct Task Planning information structures.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_task_list</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>add_task</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remove_task</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cancel_task</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>link_perfomed_action</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>etc</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_with_other_openehr_ehr_artefacts"><a class="anchor" href="#_relationship_with_other_openehr_ehr_artefacts"></a>8. Relationship with other openEHR EHR Artefacts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_todo"><a class="anchor" href="#_todo"></a>8.1. TODO</h3>
<div class="paragraph">
<p>One of the side-effects of distinct state machines for <code>INSTRUCTIONs</code> and Task Plans is that not all careflow steps and states in the former need to be represented as Tasks in a Task Plan. For example, a significant number of careflow steps defined in <code>ACTION</code> archetypes are for non-Active states, i.e. Planning, Postponement, Suspension etc. These steps do not need to have Tasks defined for them, since by definition they are nearly all unplanned.</p>
</div>
<div class="paragraph">
<p>As a consequence, most Tasks in a Task Plan correspond only to Active-state careflow steps of constituent order <code>INSTRUCTIONs</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_time_ehr_structures"><a class="anchor" href="#_execution_time_ehr_structures"></a>8.2. Execution-time EHR Structures</h3>
<div class="paragraph">
<p>The model described here provides significant power when used with openEHR Instructions, Actions and Observations to represent clinical work driven by guidelines and order sets. This section describes the relationship of information instances that correspond to the various phases of work described earlier, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ordering</em>: creation of <code>INSTRUCTIONs</code>;</p>
</li>
<li>
<p><em>task planning</em>: creation of <code>TASK_PLAN(s)</code> representing a plan of individual tasks that achieve the order intention;</p>
</li>
<li>
<p><em>execution</em>: creation of <code>ACTION</code> and other Entry types that document the Tasks as they were performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The model supports logical linking between these items to support workflow traceability. The following figure illustrates both aspects, which are further described below.</p>
</div>
<div id="runtime_planning_structures" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/planning_runtime_structures.svg" alt="planning runtime structures" width="80%">
</div>
<div class="title">Figure 21. Runtime planning structures</div>
</div>
<div class="paragraph">
<p>Various links can be recorded at execution time, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>planned Task to Order reference</strong>: the <code>TASK_EVENT_RECORD.entry_instances</code> attribute is used to record reverse reference(s) from a <code>TASK</code> to an <code>ACTIVITY</code> within an <code>INSTRUCTION</code> that records a corresponding order, if one exists (shown on the diagram as a logical link from <code>DEFINED_TASK</code> to <code>ACTIVITY</code> instances);</p>
</li>
<li>
<p><strong>planned Task to performed Task reference</strong>: the <code>TASK_EVENT_RECORD.entry_instances</code> attribute is used to record a forward reference to the Entry instance that was created when this Task was performed, i.e. some <code>ACTION</code>, <code>OBSERVATION</code> etc (shown on the diagram as a logical link from <code>DEFINED_TASK</code> to <code>ACTION</code> instances);</p>
</li>
<li>
<p><strong>performed Task to planned Task reference</strong>: the <code>ENTRY.<em>workflow_id</em></code> attribute may be used to record a reverse reference from an <code>ACTION</code>, <code>OBSERVATION</code> etc to a causing <code>TASK</code> instance.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scenarios"><a class="anchor" href="#_scenarios"></a>9. Scenarios</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_protocol_driven_plan"><a class="anchor" href="#_protocol_driven_plan"></a>9.1. Protocol-driven Plan</h3>
<div class="paragraph tbd">
<p>This section to be rewritten.</p>
</div>
<div class="paragraph">
<p>The following UML instance diagram shows a partial state of an EHR containing orders and a related Task Plan. The upper part shows a <code>COMPOSITION</code> containing a number of <code>INSTRUCTIONs</code> that express the orders for Cyclophosphamide, Hydroxydaunorubicin (Doxorubicin), etc, that make up the order set for a CHOP chemotherapy protocol (to be more complete, Rituximab would also be included). It is assumed that the orders contain the correct dosages for the patient, i.e. that they have been calculated in advance for the patient&#8217;s body weight, surface area and other specifics. A few elements of an <code>ACTIVITY</code> for the Cyclophosphamide drug are shown here.</p>
</div>
<div class="paragraph">
<p>In the lower part of the part of the diagram is a <code>COMPOSITION</code> containing a <code>TASK_PLAN</code> structure representing the list of work items to perform in order to administer the chemotherapy to the patient. It is assumed that a specialised chemotherapy application has been used to created this structure. The first <code>DEFINED_TASK</code> is shown in some detail, and includes a reference back to the related Instruction Activity, enabling an application to retrieve and display the details of the order. As a precaution, it also has the <code><em>description</em></code> attribute set to the value <code>"Cyclophosphamide 1400 mg IV"</code>, copied (or generated) from the <code>INSTRUCTION</code> when the <code>TASK_PLAN</code> was created. The other attributes of the <code>DEFINED_TASK</code> object indicate when to execute the Task, what professional role should do it (<code><em>participations</em></code>), the Careflow step ('administer') and the target state machine state (<code>active</code>).</p>
</div>
<div class="paragraph">
<p>Each of the <code>DEFINED_TASK</code> protype instances in the <code>TASK_PLAN</code> should logically speaking be almost a copy of the <code>ACTION</code> that would result from performing the Task. This is not literally true, since there are fields representing various kinds of links, identifiers and other protocol and care plan information, but for the core information of what to do, and when to do it the instance data for a Planned action should be a tight constraint version of the intended Action to result.</p>
</div>
<div id="planning_typical_instance" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/Planning-typical-instance.svg" alt="Planning typical instance">
</div>
<div class="title">Figure 22. Typical Task Plan - CHOP Chemotherapy</div>
</div>
<div class="paragraph">
<p>It is worth considering some of the differences between how an order represents the Task and how it may be represented in a <code>DEFINED_TASK</code> and an eventual <code>ACTION</code>. Consider the fourth drug in the CHOP regimen, a choice of Prednisone or Prednisolone. In the form expressed in the order, i.e. the <code>INSTRUCTION</code>, it may be expressed in the following form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>administer 80mg orally every day for 5 days</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This could be expressed as a single <code>ACTIVITY</code> with the <code>INSTRUCTION.<em>timing</em></code> attribute set to represent 'once a day for 5 days'.</p>
</div>
<div class="paragraph">
<p>In the <code>TASK_PLAN</code> however, it will be expressed as 5 separate <code>DEFINED_TASK</code> instances, each with an associated prototype <code>ACTION</code> instance. Each of these indicates a single dose for one day. This corresponds to how the drug is actually administered and enables the system (and openEHR data) to represent each action individually, as well as deviations such as not performing one or more of the administrations. The information displayed representing each Task to the human agent will therefore be somewhat different to the form in which it is expressed in the generating order.</p>
</div>
<div class="paragraph">
<p>However, the order <code>INSTRUCTION</code> could have been created using a series of 5 <code>ACTIVITY</code> objects each representing a single day&#8217;s administration. In this case, the form defined in each <code>ACTIVITY</code> is very close to the form required to represent each Task in the Task Plan.</p>
</div>
<div class="paragraph">
<p>It is assumed that determining how to populate the details of the <code>DEFINED_TASK</code> is up to an intelligent application that knows the relationship between the relevant orders or order sets, and the exact form of Task Plans to implement them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_list_and_sign_off"><a class="anchor" href="#_check_list_and_sign_off"></a>9.2. Check-list and Sign-off</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_changes_during_execution"><a class="anchor" href="#_changes_during_execution"></a>9.3. Changes during Execution</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_abandonment"><a class="anchor" href="#_abandonment"></a>9.4. Abandonment</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_guidance"><a class="anchor" href="#_implementation_guidance"></a>10. Implementation Guidance</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_workflow_application_design"><a class="anchor" href="#_workflow_application_design"></a>10.1. Workflow Application Design</h3>
<div class="paragraph">
<p>TODO:</p>
</div>
</div>
<div class="sect2">
<h3 id="_versioning"><a class="anchor" href="#_versioning"></a>10.2. Versioning</h3>
<div class="paragraph">
<p>The information structures described in this specification may in some cases become non-trivial in size and complexity, and some attention as to when changing states of a Task Plan are committed to the EHR is likely to be needed. When a Task Plan is first instantiated, it may be committed to the EHR in order to act as a shared, visible statement of outstanding work, particularly work to be done by teams and/or across shift boundaries. When the work is underway, although it would be possible to commit changes due to changing lifecycle states of each Task, it may be preferable to allow these changes to be tracked only by the workflow application and for the Task Plan to only be recommitted once completed or abandoned, or possibly at strategic points in time prior to this, for example nursing shift changes.</p>
</div>
<div class="paragraph">
<p>It does not appear likely that any single rule for when to commit the changed state of a Task Plan to the EHR can be established for all possible situations, but it is recommended that the commit points are chosen carefully so that their meaning is clear.</p>
</div>
<div class="paragraph">
<p>Interim commits of a Task Plan to a persistent store for workflow management or some other application may of course be useful.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_publications"><a class="anchor" href="#_publications"></a>Publications</h3>
<div class="olist bibliography">
<ol class="bibliography">
<li>
<p><a id="van_der_Aalst_2005a"></a>[van_der_Aalst_2005a] Van der Aalst, Weske, Grunbauer. <strong>Case Handling: A New Paradigm for Business Process Support.</strong> Data and Knowledge Engineering, 53(2):129-162, 2005.</p>
</li>
<li>
<p><a id="van_der_Aalst_2013a"></a>[van_der_Aalst_2013a] Wil van der Aalst. <strong>Business Process Management: A Comprehensive Survey.</strong> ISRN Software Engineering, pages 1-37, 2013. doi:10.1155/2013/507984.</p>
</li>
<li>
<p><a id="Baretto_2005"></a>[Baretto_2005] Barretto S A. <strong>Designing Guideline-based Workflow-Integrated Electronic Health Records.</strong> 2005. PhD dissertation, University of South Australia. Available at <a href="http://www.cis.unisa.edu.au/~cissab/Barretto_PhD_Thesis_Revised_FINAL.pdf" class="bare">http://www.cis.unisa.edu.au/~cissab/Barretto_PhD_Thesis_Revised_FINAL.pdf</a>.</p>
</li>
<li>
<p><a id="Beale_2000"></a>[Beale_2000] Beale T. <strong>Archetypes: Constraint-based Domain Models for Future-proof Information Systems.</strong> 2000.  Available at <a href="http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_web_2000.pdf" class="bare">http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_web_2000.pdf</a> .</p>
</li>
<li>
<p><a id="Beale_2002"></a>[Beale_2002] Beale T. <strong>Archetypes: Constraint-based Domain Models for Future-proof Information Systems.</strong> Eleventh OOPSLA Workshop on Behavioral Semantics: Serving the Customer (Seattle, Washington, USA, November 4, 2002). Edited by Kenneth Baclawski and Haim Kilov. Northeastern University, Boston, 2002, pp. 16-32. Available at <a href="http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_oopsla_2002.pdf" class="bare">http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_oopsla_2002.pdf</a> .</p>
</li>
<li>
<p><a id="BPTrends_2009"></a>[BPTrends_2009] <strong>Case Management: Combining Knowledge With Process.</strong> White paper in BPTrends July 2009.</p>
</li>
<li>
<p><a id="Browne_2005"></a>[Browne_2005] Eric Browne. <strong>Workflow Modelling of Coordinated Inter-Health-Provider Care Plans.</strong> PhD thesis submitted to the School of Computer and Information Science, University of South Australia. January 2005.</p>
</li>
<li>
<p><a id="GLIF"></a>[GLIF] Lucila Ohno-Machado, John H. Gennari, Shawn N. Murphy, Nilesh L. Jain, Samson W. Tu, Diane E. Oliver, Edward Pattison-Gordon, Robert A. Greenes, Edward H. Shortliffe, and G. Octo Barnett.  <strong>The GuideLine Interchange Format - A Model for Representing Guidelines</strong>. J Am Med Inform Assoc. 1998 Jul-Aug; 5(4): 357–372.</p>
</li>
<li>
<p><a id="Hull_et_al_2010a"></a>[Hull_et_al_2010a] Richard Hull et al. <strong>Introducing the Guard-Stage-Milestone Approach for Specifying Business Entity Lifecycles.</strong> Preprint from Proc. Intl. Workshop on Web Services and Formal Methods (WS-FM), 2010. To appear in Springer-VerlagLNCS 6551.</p>
</li>
<li>
<p><a id="Mulyar_et_al_2007"></a>[Mulyar_et_al_2007]  Nataliya Mulyar, Maja Pesic, Wil M.P. van der Aalst and Mor Peleg. <strong>Declarative and Procedural Approaches for Modelling Clinical Guidelines: Addressing Flexibility Issues.</strong> Conference: Business Process Management Workshops, BPM 2007 International Workshops, BPI, BPD, CBP, ProHealth, RefMod, semantics4ws, Brisbane, Australia, September 24, 2007.</p>
</li>
<li>
<p><a id="Mulyar_et_al_2008"></a>[Mulyar_et_al_2008] Nataliya Mulyar, Maja Pesic, Wil M.P. van der Aalst and Mor Peleg. <strong>Towards the Flexibility in Clinical Guideline Modelling Languages.</strong></p>
</li>
<li>
<p><a id="Hofstede_van_der_Aalst_2009"></a>[Hofstede_van_der_Aalst_2009] Hofstede, van der Aalst et al. <strong>Modern Business Process Automation: YAWL and its Support Environment.</strong> Springer 2009.</p>
</li>
<li>
<p><a id="Mei_et_al_2014"></a>[Mei_et_al_2014] Jing MEI, Jing LI, Yiqin YU, Xiang LI, Haifeng LIU and Guotong XIE. <strong>Embracing case management for computerization of care pathways.</strong> e-Health – For Continuity of Care C. Lovis et al. (Eds.) 2014 European Federation for Medical Informatics and IOS Press. doi:10.3233/978-1-61499-432-9-3</p>
</li>
<li>
<p><a id="Müller_2003"></a>[Müller_2003] Robert Müller. <strong>Event-Oriented Dynamic Adaptation of Workflows: Model, Architecture, and Implementation.</strong> PhD thesis submitted to Fakultät für Mathematik und Informatik at the Universität Leipzig, 2003.</p>
</li>
<li>
<p><a id="Pescosolido"></a>[Pescosolido] Bernice A. Pescosolido, Indiana University, USA. <strong>Patient trajectories.</strong> <a href="http://onlinelibrary.wiley.com/doi/10.1002/9781118410868.wbehibs282/pdf">Wiley Online Library</a></p>
</li>
<li>
<p><a id="Russell_et_al_2007"></a>[Russell_et_al_2007]  N. Russell, A.H.M. ter Hofstede, and W.M.P. van der Aalst. <strong>newYAWL: Specifying a Workflow Reference Language using Coloured Petri Nets.</strong> In K. Jensen, editor, Proceedings of the Eighth Workshop on the Practical Use of Coloured Petri Nets and CPN Tools (CPN 2007), volume 584 of DAIMI, pages 107-126, Aarhus, Denmark, October 2007. University of Aarhus.</p>
</li>
<li>
<p><a id="Schrijvers_et_al_2012"></a>[Schrijvers_et_al_2012] Guus Schrijvers, Arjan van Hoorn, Nicolette Huiskes. <strong>The Care Pathway Concept: concepts and theories: an introduction.</strong> International Journal of Integrated Care. 2012;12(6). DOI: <a href="http://doi.org/10.5334/ijic.812" class="bare">http://doi.org/10.5334/ijic.812</a></p>
</li>
<li>
<p><a id="Vanhaecht_et_al_2007"></a>[Vanhaecht_et_al_2007] Vanhaecht K, De Witte K, Sermeus W. <strong>The impact of clinical pathways on the organisation of care processes.</strong> PhD dissertation, Belgium: KU Leuven; 2007.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-06-12 11:55:04 BST
</div>
</div>
</body>
</html>